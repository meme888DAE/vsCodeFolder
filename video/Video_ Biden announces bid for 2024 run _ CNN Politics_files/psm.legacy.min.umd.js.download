(()=>{var Yi=Object.create;var it=Object.defineProperty,Zi=Object.defineProperties,Xi=Object.getOwnPropertyDescriptor,es=Object.getOwnPropertyDescriptors,ts=Object.getOwnPropertyNames,tn=Object.getOwnPropertySymbols,rs=Object.getPrototypeOf,nn=Object.prototype.hasOwnProperty,ns=Object.prototype.propertyIsEnumerable;var rn=(e,r,t)=>r in e?it(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,P=(e,r)=>{for(var t in r||(r={}))nn.call(r,t)&&rn(e,t,r[t]);if(tn)for(var t of tn(r))ns.call(r,t)&&rn(e,t,r[t]);return e},te=(e,r)=>Zi(e,es(r));var z=(e,r)=>()=>(e&&(r=e(e=0)),r);var Z=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),os=(e,r)=>{for(var t in r)it(e,t,{get:r[t],enumerable:!0})},on=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of ts(r))!nn.call(e,o)&&o!==t&&it(e,o,{get:()=>r[o],enumerable:!(n=Xi(r,o))||n.enumerable});return e};var or=(e,r,t)=>(t=e!=null?Yi(rs(e)):{},on(r||!e||!e.__esModule?it(t,"default",{value:e,enumerable:!0}):t,e)),is=e=>on(it({},"__esModule",{value:!0}),e);function st(){if(!It&&(It=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!It))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return It(ss)}var It,ss,ir=z(()=>{ss=new Uint8Array(16)});var sn,an=z(()=>{sn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function as(e){return typeof e=="string"&&sn.test(e)}var Pe,at=z(()=>{an();Pe=as});function ds(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(B[e[r+0]]+B[e[r+1]]+B[e[r+2]]+B[e[r+3]]+"-"+B[e[r+4]]+B[e[r+5]]+"-"+B[e[r+6]]+B[e[r+7]]+"-"+B[e[r+8]]+B[e[r+9]]+"-"+B[e[r+10]]+B[e[r+11]]+B[e[r+12]]+B[e[r+13]]+B[e[r+14]]+B[e[r+15]]).toLowerCase();if(!Pe(t))throw TypeError("Stringified UUID is invalid");return t}var B,Et,Ce,dt=z(()=>{at();B=[];for(Et=0;Et<256;++Et)B.push((Et+256).toString(16).substr(1));Ce=ds});function cs(e,r,t){var n=r&&t||0,o=r||new Array(16);e=e||{};var i=e.node||dn,s=e.clockseq!==void 0?e.clockseq:sr;if(i==null||s==null){var a=e.random||(e.rng||st)();i==null&&(i=dn=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),s==null&&(s=sr=(a[6]<<8|a[7])&16383)}var c=e.msecs!==void 0?e.msecs:Date.now(),d=e.nsecs!==void 0?e.nsecs:dr+1,u=c-ar+(d-dr)/1e4;if(u<0&&e.clockseq===void 0&&(s=s+1&16383),(u<0||c>ar)&&e.nsecs===void 0&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ar=c,dr=d,sr=s,c+=122192928e5;var l=((c&268435455)*1e4+d)%4294967296;o[n++]=l>>>24&255,o[n++]=l>>>16&255,o[n++]=l>>>8&255,o[n++]=l&255;var p=c/4294967296*1e4&268435455;o[n++]=p>>>8&255,o[n++]=p&255,o[n++]=p>>>24&15|16,o[n++]=p>>>16&255,o[n++]=s>>>8|128,o[n++]=s&255;for(var f=0;f<6;++f)o[n+f]=i[f];return r||Ce(o)}var dn,sr,ar,dr,cn,ln=z(()=>{ir();dt();ar=0,dr=0;cn=cs});function ls(e){if(!Pe(e))throw TypeError("Invalid UUID");var r,t=new Uint8Array(16);return t[0]=(r=parseInt(e.slice(0,8),16))>>>24,t[1]=r>>>16&255,t[2]=r>>>8&255,t[3]=r&255,t[4]=(r=parseInt(e.slice(9,13),16))>>>8,t[5]=r&255,t[6]=(r=parseInt(e.slice(14,18),16))>>>8,t[7]=r&255,t[8]=(r=parseInt(e.slice(19,23),16))>>>8,t[9]=r&255,t[10]=(r=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=r/4294967296&255,t[12]=r>>>24&255,t[13]=r>>>16&255,t[14]=r>>>8&255,t[15]=r&255,t}var Pt,cr=z(()=>{at();Pt=ls});function us(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}function Ct(e,r,t){function n(o,i,s,a){if(typeof o=="string"&&(o=us(o)),typeof i=="string"&&(i=Pt(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+o.length);if(c.set(i),c.set(o,i.length),c=t(c),c[6]=c[6]&15|r,c[8]=c[8]&63|128,s){a=a||0;for(var d=0;d<16;++d)s[a+d]=c[d];return s}return Ce(c)}try{n.name=e}catch(o){}return n.DNS=ps,n.URL=fs,n}var ps,fs,lr=z(()=>{dt();cr();ps="6ba7b810-9dad-11d1-80b4-00c04fd430c8",fs="6ba7b811-9dad-11d1-80b4-00c04fd430c8"});function gs(e){if(typeof e=="string"){var r=unescape(encodeURIComponent(e));e=new Uint8Array(r.length);for(var t=0;t<r.length;++t)e[t]=r.charCodeAt(t)}return ms(hs(vs(e),e.length*8))}function ms(e){for(var r=[],t=e.length*32,n="0123456789abcdef",o=0;o<t;o+=8){var i=e[o>>5]>>>o%32&255,s=parseInt(n.charAt(i>>>4&15)+n.charAt(i&15),16);r.push(s)}return r}function un(e){return(e+64>>>9<<4)+14+1}function hs(e,r){e[r>>5]|=128<<r%32,e[un(r)-1]=r;for(var t=1732584193,n=-271733879,o=-1732584194,i=271733878,s=0;s<e.length;s+=16){var a=t,c=n,d=o,u=i;t=K(t,n,o,i,e[s],7,-680876936),i=K(i,t,n,o,e[s+1],12,-389564586),o=K(o,i,t,n,e[s+2],17,606105819),n=K(n,o,i,t,e[s+3],22,-1044525330),t=K(t,n,o,i,e[s+4],7,-176418897),i=K(i,t,n,o,e[s+5],12,1200080426),o=K(o,i,t,n,e[s+6],17,-1473231341),n=K(n,o,i,t,e[s+7],22,-45705983),t=K(t,n,o,i,e[s+8],7,1770035416),i=K(i,t,n,o,e[s+9],12,-1958414417),o=K(o,i,t,n,e[s+10],17,-42063),n=K(n,o,i,t,e[s+11],22,-1990404162),t=K(t,n,o,i,e[s+12],7,1804603682),i=K(i,t,n,o,e[s+13],12,-40341101),o=K(o,i,t,n,e[s+14],17,-1502002290),n=K(n,o,i,t,e[s+15],22,1236535329),t=G(t,n,o,i,e[s+1],5,-165796510),i=G(i,t,n,o,e[s+6],9,-1069501632),o=G(o,i,t,n,e[s+11],14,643717713),n=G(n,o,i,t,e[s],20,-373897302),t=G(t,n,o,i,e[s+5],5,-701558691),i=G(i,t,n,o,e[s+10],9,38016083),o=G(o,i,t,n,e[s+15],14,-660478335),n=G(n,o,i,t,e[s+4],20,-405537848),t=G(t,n,o,i,e[s+9],5,568446438),i=G(i,t,n,o,e[s+14],9,-1019803690),o=G(o,i,t,n,e[s+3],14,-187363961),n=G(n,o,i,t,e[s+8],20,1163531501),t=G(t,n,o,i,e[s+13],5,-1444681467),i=G(i,t,n,o,e[s+2],9,-51403784),o=G(o,i,t,n,e[s+7],14,1735328473),n=G(n,o,i,t,e[s+12],20,-1926607734),t=$(t,n,o,i,e[s+5],4,-378558),i=$(i,t,n,o,e[s+8],11,-2022574463),o=$(o,i,t,n,e[s+11],16,1839030562),n=$(n,o,i,t,e[s+14],23,-35309556),t=$(t,n,o,i,e[s+1],4,-1530992060),i=$(i,t,n,o,e[s+4],11,1272893353),o=$(o,i,t,n,e[s+7],16,-155497632),n=$(n,o,i,t,e[s+10],23,-1094730640),t=$(t,n,o,i,e[s+13],4,681279174),i=$(i,t,n,o,e[s],11,-358537222),o=$(o,i,t,n,e[s+3],16,-722521979),n=$(n,o,i,t,e[s+6],23,76029189),t=$(t,n,o,i,e[s+9],4,-640364487),i=$(i,t,n,o,e[s+12],11,-421815835),o=$(o,i,t,n,e[s+15],16,530742520),n=$(n,o,i,t,e[s+2],23,-995338651),t=J(t,n,o,i,e[s],6,-198630844),i=J(i,t,n,o,e[s+7],10,1126891415),o=J(o,i,t,n,e[s+14],15,-1416354905),n=J(n,o,i,t,e[s+5],21,-57434055),t=J(t,n,o,i,e[s+12],6,1700485571),i=J(i,t,n,o,e[s+3],10,-1894986606),o=J(o,i,t,n,e[s+10],15,-1051523),n=J(n,o,i,t,e[s+1],21,-2054922799),t=J(t,n,o,i,e[s+8],6,1873313359),i=J(i,t,n,o,e[s+15],10,-30611744),o=J(o,i,t,n,e[s+6],15,-1560198380),n=J(n,o,i,t,e[s+13],21,1309151649),t=J(t,n,o,i,e[s+4],6,-145523070),i=J(i,t,n,o,e[s+11],10,-1120210379),o=J(o,i,t,n,e[s+2],15,718787259),n=J(n,o,i,t,e[s+9],21,-343485551),t=Oe(t,a),n=Oe(n,c),o=Oe(o,d),i=Oe(i,u)}return[t,n,o,i]}function vs(e){if(e.length===0)return[];for(var r=e.length*8,t=new Uint32Array(un(r)),n=0;n<r;n+=8)t[n>>5]|=(e[n/8]&255)<<n%32;return t}function Oe(e,r){var t=(e&65535)+(r&65535),n=(e>>16)+(r>>16)+(t>>16);return n<<16|t&65535}function ys(e,r){return e<<r|e>>>32-r}function Ot(e,r,t,n,o,i){return Oe(ys(Oe(Oe(r,e),Oe(n,i)),o),t)}function K(e,r,t,n,o,i,s){return Ot(r&t|~r&n,e,r,o,i,s)}function G(e,r,t,n,o,i,s){return Ot(r&n|t&~n,e,r,o,i,s)}function $(e,r,t,n,o,i,s){return Ot(r^t^n,e,r,o,i,s)}function J(e,r,t,n,o,i,s){return Ot(t^(r|~n),e,r,o,i,s)}var pn,fn=z(()=>{pn=gs});var Ss,gn,mn=z(()=>{lr();fn();Ss=Ct("v3",48,pn),gn=Ss});function _s(e,r,t){e=e||{};var n=e.random||(e.rng||st)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var o=0;o<16;++o)r[t+o]=n[o];return r}return Ce(n)}var pe,hn=z(()=>{ir();dt();pe=_s});function bs(e,r,t,n){switch(e){case 0:return r&t^~r&n;case 1:return r^t^n;case 2:return r&t^r&n^t&n;case 3:return r^t^n}}function ur(e,r){return e<<r|e>>>32-r}function ws(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var n=unescape(encodeURIComponent(e));e=[];for(var o=0;o<n.length;++o)e.push(n.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var i=e.length/4+2,s=Math.ceil(i/16),a=new Array(s),c=0;c<s;++c){for(var d=new Uint32Array(16),u=0;u<16;++u)d[u]=e[c*64+u*4]<<24|e[c*64+u*4+1]<<16|e[c*64+u*4+2]<<8|e[c*64+u*4+3];a[c]=d}a[s-1][14]=(e.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(e.length-1)*8&4294967295;for(var l=0;l<s;++l){for(var p=new Uint32Array(80),f=0;f<16;++f)p[f]=a[l][f];for(var g=16;g<80;++g)p[g]=ur(p[g-3]^p[g-8]^p[g-14]^p[g-16],1);for(var m=t[0],h=t[1],y=t[2],w=t[3],b=t[4],T=0;T<80;++T){var E=Math.floor(T/20),C=ur(m,5)+bs(E,h,y,w)+b+r[E]+p[T]>>>0;b=w,w=y,y=ur(h,30)>>>0,h=m,m=C}t[0]=t[0]+m>>>0,t[1]=t[1]+h>>>0,t[2]=t[2]+y>>>0,t[3]=t[3]+w>>>0,t[4]=t[4]+b>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var vn,yn=z(()=>{vn=ws});var Ts,Sn,_n=z(()=>{lr();yn();Ts=Ct("v5",80,vn),Sn=Ts});var bn,wn=z(()=>{bn="00000000-0000-0000-0000-000000000000"});function Is(e){if(!Pe(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var Tn,In=z(()=>{at();Tn=Is});var En={};os(En,{NIL:()=>bn,parse:()=>Pt,stringify:()=>Ce,v1:()=>cn,v3:()=>gn,v4:()=>pe,v5:()=>Sn,validate:()=>Pe,version:()=>Tn});var He=z(()=>{ln();mn();hn();_n();wn();In();at();dt();cr()});var ao=Z(so=>{var je=256,Ut=[],Nt;for(;je--;)Ut[je]=(je+256).toString(16).substring(1);function qa(){var e=0,r,t="";if(!Nt||je+16>256){for(Nt=Array(e=256);e--;)Nt[e]=256*Math.random()|0;e=je=0}for(;e<16;e++)r=Nt[je+e],e==6?t+=Ut[r&15|64]:e==8?t+=Ut[r&63|128]:t+=Ut[r],e&1&&e>1&&e<11&&(t+="-");return je++,t}so.v4=qa});var Vt=Z((pu,lo)=>{"use strict";var Ba=Object.prototype.hasOwnProperty,Ha=String.prototype.charAt,Wa=Object.prototype.toString,Ka=function(e,r){return Ha.call(e,r)},yr=function(r,t){return Ba.call(r,t)},Ga=function(r){return Wa.call(r)==="[object String]"},$a=function(r){return r!=null&&typeof r!="function"&&typeof r.length=="number"},co=function(r,t){t=t||yr;for(var n=[],o=0,i=r.length;o<i;o+=1)t(r,o)&&n.push(String(o));return n},Ja=function(r,t){t=t||yr;var n=[];for(var o in r)t(r,o)&&n.push(String(o));return n},Qa=function(r){return r==null?[]:Ga(r)?co(r,Ka):$a(r)?co(r,yr):Ja(r)};lo.exports=Qa});var br=Z((fu,_r)=>{"use strict";var Sr=Vt(),za=(He(),is(En)).v4,uo={_data:{},length:0,setItem:function(e,r){return this._data[e]=r,this.length=Sr(this._data).length,r},getItem:function(e){return e in this._data?this._data[e]:null},removeItem:function(e){return e in this._data&&delete this._data[e],this.length=Sr(this._data).length,null},clear:function(){this._data={},this.length=0},key:function(e){return Sr(this._data)[e]}};function Ya(){try{if(!window.localStorage)return!1;var e=za();window.localStorage.setItem(e,"test_value");var r=window.localStorage.getItem(e);return window.localStorage.removeItem(e),r==="test_value"}catch(t){return!1}}function Za(){return Ya()?window.localStorage:uo}_r.exports.defaultEngine=Za();_r.exports.inMemoryEngine=uo});var Ft=Z((gu,fo)=>{"use strict";var Xa=Vt(),po=Object.prototype.toString,ed=function(r){var t=typeof r;return t==="number"||t==="object"&&po.call(r)==="[object Number]"},td=typeof Array.isArray=="function"?Array.isArray:function(r){return po.call(r)==="[object Array]"},rd=function(r){return r!=null&&(td(r)||r!=="function"&&ed(r.length))},nd=function(r,t){for(var n=0;n<t.length&&r(t[n],n,t)!==!1;n+=1);},od=function(r,t){for(var n=Xa(t),o=0;o<n.length&&r(t[n[o]],n[o],t)!==!1;o+=1);},id=function(r,t){return(rd(t)?nd:od).call(this,r,t)};fo.exports=id});var yo=Z((mu,vo)=>{"use strict";var sd=br().defaultEngine,go=br().inMemoryEngine,mo=Ft(),ad=Vt(),ho=JSON;function Ne(e,r,t,n){this.id=r,this.name=e,this.keys=t||{},this.engine=n||sd,this.originalEngine=this.engine}Ne.prototype.set=function(e,r){var t=this._createValidKey(e);if(!!t)try{this.engine.setItem(t,ho.stringify(r))}catch(n){dd(n)&&(this._swapEngine(),this.set(e,r))}};Ne.prototype.get=function(e){try{var r=this.engine.getItem(this._createValidKey(e));return r===null?null:ho.parse(r)}catch(t){return null}};Ne.prototype.getOriginalEngine=function(){return this.originalEngine};Ne.prototype.remove=function(e){this.engine.removeItem(this._createValidKey(e))};Ne.prototype._createValidKey=function(e){var r=this.name,t=this.id;if(!ad(this.keys).length)return[r,t,e].join(".");var n;return mo(function(o){o===e&&(n=[r,t,e].join("."))},this.keys),n};Ne.prototype._swapEngine=function(){var e=this;mo(function(r){var t=e.get(r);go.setItem([e.name,e.id,r].join("."),t),e.remove(r)},this.keys),this.engine=go};vo.exports=Ne;function dd(e){var r=!1;if(e.code)switch(e.code){case 22:r=!0;break;case 1014:e.name==="NS_ERROR_DOM_QUOTA_REACHED"&&(r=!0);break;default:break}else e.number===-2147024882&&(r=!0);return r}});var bo=Z((hu,_o)=>{"use strict";var cd=Ft(),ld=2,So={setTimeout:function(e,r){return window.setTimeout(e,r)},clearTimeout:function(e){return window.clearTimeout(e)},Date:window.Date},Je=So,qt={ASAP:1,RESCHEDULE:2,ABANDON:3};function Se(){this.tasks={},this.nextId=1}Se.prototype.now=function(){return+new Je.Date};Se.prototype.run=function(e,r,t){var n=this.nextId++;return this.tasks[n]=Je.setTimeout(this._handle(n,e,r,t||qt.ASAP),r),n};Se.prototype.cancel=function(e){this.tasks[e]&&(Je.clearTimeout(this.tasks[e]),delete this.tasks[e])};Se.prototype.cancelAll=function(){cd(Je.clearTimeout,this.tasks),this.tasks={}};Se.prototype._handle=function(e,r,t,n){var o=this,i=o.now();return function(){if(delete o.tasks[e],n>=qt.RESCHEDULE&&i+t*ld<o.now()){n===qt.RESCHEDULE&&o.run(r,t,n);return}return r()}};Se.setClock=function(e){Je=e};Se.resetClock=function(){Je=So};Se.Modes=qt;_o.exports=Se});var To=Z((vu,wo)=>{wo.exports=U;function U(e){return U.enabled(e)?function(r){r=ud(r);var t=new Date,n=t-(U[e]||t);U[e]=t,r=e+" "+r+" +"+U.humanize(n),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}U.names=[];U.skips=[];U.enable=function(e){try{localStorage.debug=e}catch(o){}for(var r=(e||"").split(/[\s,]+/),t=r.length,n=0;n<t;n++)e=r[n].replace("*",".*?"),e[0]==="-"?U.skips.push(new RegExp("^"+e.substr(1)+"$")):U.names.push(new RegExp("^"+e+"$"))};U.disable=function(){U.enable("")};U.humanize=function(e){var r=1e3,t=60*1e3,n=60*t;return e>=n?(e/n).toFixed(1)+"h":e>=t?(e/t).toFixed(1)+"m":e>=r?(e/r|0)+"s":e+"ms"};U.enabled=function(e){for(var r=0,t=U.skips.length;r<t;r++)if(U.skips[r].test(e))return!1;for(var r=0,t=U.names.length;r<t;r++)if(U.names[r].test(e))return!0;return!1};function ud(e){return e instanceof Error?e.stack||e.message:e}try{window.localStorage&&U.enable(localStorage.debug)}catch(e){}});var Io=Z((yu,wr)=>{typeof wr<"u"&&(wr.exports=ne);function ne(e){if(e)return pd(e)}function pd(e){for(var r in ne.prototype)e[r]=ne.prototype[r];return e}ne.prototype.on=ne.prototype.addEventListener=function(e,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(r),this};ne.prototype.once=function(e,r){function t(){this.off(e,t),r.apply(this,arguments)}return t.fn=r,this.on(e,t),this};ne.prototype.off=ne.prototype.removeListener=ne.prototype.removeAllListeners=ne.prototype.removeEventListener=function(e,r){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+e];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,o=0;o<t.length;o++)if(n=t[o],n===r||n.fn===r){t.splice(o,1);break}return t.length===0&&delete this._callbacks["$"+e],this};ne.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var r=new Array(arguments.length-1),t=this._callbacks["$"+e],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,o=t.length;n<o;++n)t[n].apply(this,r)}return this};ne.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ne.prototype.hasListeners=function(e){return!!this.listeners(e).length}});var Pr=Z((Su,Eo)=>{"use strict";var pt=ao().v4,Ir=yo(),Er=Ft(),Qe=bo(),fd=To()("localstorage-retry"),gd=Io();function Tr(e,r){return function(){return e.apply(r,arguments)}}function oe(e,r,t){typeof r=="function"&&(t=r),this.name=e,this.id=pt(),this.fn=t,this.maxItems=r.maxItems||1/0,this.maxAttempts=r.maxAttempts||1/0,this.backoff={MIN_RETRY_DELAY:r.minRetryDelay||1e3,MAX_RETRY_DELAY:r.maxRetryDelay||3e4,FACTOR:r.backoffFactor||2,JITTER:r.backoffJitter||0},this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500},this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack"},this._schedule=new Qe,this._processId=0,this._store=new Ir(this.name,this.id,this.keys),this._store.set(this.keys.IN_PROGRESS,{}),this._store.set(this.keys.QUEUE,[]),this._ack=Tr(this._ack,this),this._checkReclaim=Tr(this._checkReclaim,this),this._processHead=Tr(this._processHead,this),this._running=!1}gd(oe.prototype);oe.prototype.start=function(){this._running&&this.stop(),this._running=!0,this._ack(),this._checkReclaim(),this._processHead()};oe.prototype.stop=function(){this._schedule.cancelAll(),this._running=!1};oe.prototype.shouldRetry=function(e,r){return!(r>this.maxAttempts)};oe.prototype.getDelay=function(e){var r=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,e);if(this.backoff.JITTER){var t=Math.random(),n=Math.floor(t*this.backoff.JITTER*r);Math.floor(t*10)<5?r-=n:r+=n}return Number(Math.min(r,this.backoff.MAX_RETRY_DELAY).toPrecision(1))};oe.prototype.addItem=function(e){this._enqueue({item:e,attemptNumber:0,time:this._schedule.now(),id:pt()})};oe.prototype.requeue=function(e,r,t,n){this.shouldRetry(e,r,t)?this._enqueue({item:e,attemptNumber:r,time:this._schedule.now()+this.getDelay(r),id:n||pt()}):this.emit("discard",e,r)};oe.prototype._enqueue=function(e){var r=this._store.get(this.keys.QUEUE)||[];r=r.slice(-(this.maxItems-1)),r.push(e),r=r.sort(function(t,n){return t.time-n.time}),this._store.set(this.keys.QUEUE,r),this._running&&this._processHead()};oe.prototype._processHead=function(){var e=this,r=this._store;this._schedule.cancel(this._processId);var t=r.get(this.keys.QUEUE)||[],n=r.get(this.keys.IN_PROGRESS)||{},o=this._schedule.now(),i=[];function s(u,l){i.push({item:u.item,done:function(f,g){var m=r.get(e.keys.IN_PROGRESS)||{};delete m[l],r.set(e.keys.IN_PROGRESS,m),e.emit("processed",f,g,u.item),f&&e.requeue(u.item,u.attemptNumber+1,f,u.id)}})}for(var a=Object.keys(n).length;t.length&&t[0].time<=o&&a++<e.maxItems;){var c=t.shift(),d=pt();n[d]={item:c.item,attemptNumber:c.attemptNumber,time:e._schedule.now()},s(c,d)}r.set(this.keys.QUEUE,t),r.set(this.keys.IN_PROGRESS,n),Er(function(u){try{e.fn(u.item,u.done)}catch(l){fd("Process function threw error: "+l)}},i),t=r.get(this.keys.QUEUE)||[],this._schedule.cancel(this._processId),t.length>0&&(this._processId=this._schedule.run(this._processHead,t[0].time-o,Qe.Modes.ASAP))};oe.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now()),this._store.set(this.keys.RECLAIM_START,null),this._store.set(this.keys.RECLAIM_END,null),this._schedule.run(this._ack,this.timeouts.ACK_TIMER,Qe.Modes.ASAP)};oe.prototype._checkReclaim=function(){var e=this;function r(n){n.set(e.keys.RECLAIM_START,e.id),n.set(e.keys.ACK,e._schedule.now()),e._schedule.run(function(){n.get(e.keys.RECLAIM_START)===e.id&&(n.set(e.keys.RECLAIM_END,e.id),e._schedule.run(function(){n.get(e.keys.RECLAIM_END)===e.id&&n.get(e.keys.RECLAIM_START)===e.id&&e._reclaim(n.id)},e.timeouts.RECLAIM_WAIT,Qe.Modes.ABANDON))},e.timeouts.RECLAIM_WAIT,Qe.Modes.ABANDON)}function t(n){for(var o=[],i=e._store.getOriginalEngine(),s=0;s<i.length;s++){var a=i.key(s),c=a.split(".");c.length===3&&c[0]===n&&c[2]==="ack"&&o.push(new Ir(n,c[1],e.keys))}return o}Er(function(n){n.id!==e.id&&(e._schedule.now()-n.get(e.keys.ACK)<e.timeouts.RECLAIM_TIMEOUT||r(n))},t(this.name)),this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER,Qe.Modes.RESCHEDULE)};oe.prototype._reclaim=function(e){var r=this,t=new Ir(this.name,e,this.keys),n={queue:this._store.get(this.keys.QUEUE)||[]},o={inProgress:t.get(this.keys.IN_PROGRESS)||{},queue:t.get(this.keys.QUEUE)||[]},i=[],s=function(a,c){Er(function(d){var u=d.id||pt();i.indexOf(u)>=0?r.emit("duplication",d.item,d.attemptNumber):(n.queue.push({item:d.item,attemptNumber:d.attemptNumber+c,time:r._schedule.now(),id:u}),i.push(u))},a)};s(o.queue,0),s(o.inProgress,1),n.queue=n.queue.sort(function(a,c){return a.time-c.time}),this._store.set(this.keys.QUEUE,n.queue),t.remove(this.keys.IN_PROGRESS),t.remove(this.keys.QUEUE),t.remove(this.keys.RECLAIM_START),t.remove(this.keys.RECLAIM_END),t.remove(this.keys.ACK),this._processHead()};Eo.exports=oe});var Li=Z(N=>{"use strict";N.__esModule=!0;N.COPPAPrivacyModesEnum=N.BrandsEnum=N.EnvNames=N.PlayerMediaStates=N.ResponseHandlers=N.ResponseStatusCodes=void 0;var Wc;(function(e){e[e.Code201Created=201]="Code201Created",e[e.Code400BadRequest=400]="Code400BadRequest",e[e.Code999Test=999]="Code999Test"})(Wc=N.ResponseStatusCodes||(N.ResponseStatusCodes={}));var Kc;(function(e){e.Success="Success",e.Failure="Failure",e.Retry="Retry"})(Kc=N.ResponseHandlers||(N.ResponseHandlers={}));var Gc;(function(e){e.PLAYING="playing",e.PENDING="pending"})(Gc=N.PlayerMediaStates||(N.PlayerMediaStates={}));var $c;(function(e){e.PROD="PROD",e.DEV="DEV",e.INTEGRATION="INTEGRATION",e.QA="TEST"})($c=N.EnvNames||(N.EnvNames={}));var Jc;(function(e){e.TBS="TBS",e.CNN="CNN",e.CartoonNetwork="CartoonNetwork",e.AdultSwim="AdultSwim",e.TNT="TNT",e.truTV="truTV",e.TCM="TCM",e.BR="BR",e.NCAA="NCAA",e.WMInternalEvents="WMInternalEvents",e.MML="MML",e.WMSpecialEvents="WMSpecialEvents",e.psmInvalidType="psmInvalidType"})(Jc=N.BrandsEnum||(N.BrandsEnum={}));var Qc;(function(e){e.ALL_ID="ALL_ID",e.ZERO_ID="ZERO_ID"})(Qc=N.COPPAPrivacyModesEnum||(N.COPPAPrivacyModesEnum={}))});var Ni=Z(ji=>{"use strict";ji.__esModule=!0});var Vi=Z(Ui=>{"use strict";Ui.__esModule=!0});var qi=Z(Fi=>{"use strict";Fi.__esModule=!0});var Bi=Z(he=>{"use strict";var zc=he&&he.__createBinding||(Object.create?function(e,r,t,n){n===void 0&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);(!o||("get"in o?!r.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){n===void 0&&(n=t),e[n]=r[t]}),rr=he&&he.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&zc(r,e,t)};he.__esModule=!0;rr(Li(),he);rr(Ni(),he);rr(Vi(),he);rr(qi(),he)});He();var Es=Object.create,xn=Object.defineProperty,Ps=Object.getOwnPropertyDescriptor,Ln=Object.getOwnPropertyNames,Cs=Object.getPrototypeOf,Os=Object.prototype.hasOwnProperty,ut=(e,r)=>function(){return r||(0,e[Ln(e)[0]])((r={exports:{}}).exports,r),r.exports},As=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Ln(r))!Os.call(e,o)&&o!==t&&xn(e,o,{get:()=>r[o],enumerable:!(n=Ps(r,o))||n.enumerable});return e},Ms=(e,r,t)=>(t=e!=null?Es(Cs(e)):{},As(r||!e||!e.__esModule?xn(t,"default",{value:e,enumerable:!0}):t,e)),Rs=ut({"../types/dist/enums.js"(e){"use strict";e.__esModule=!0,e.COPPAPrivacyModesEnum=e.BrandsEnum=e.EnvNames=e.PlayerMediaStates=e.ResponseHandlers=e.ResponseStatusCodes=void 0;var r;(function(a){a[a.Code201Created=201]="Code201Created",a[a.Code400BadRequest=400]="Code400BadRequest",a[a.Code999Test=999]="Code999Test"})(r=e.ResponseStatusCodes||(e.ResponseStatusCodes={}));var t;(function(a){a.Success="Success",a.Failure="Failure",a.Retry="Retry"})(t=e.ResponseHandlers||(e.ResponseHandlers={}));var n;(function(a){a.PLAYING="playing",a.PENDING="pending"})(n=e.PlayerMediaStates||(e.PlayerMediaStates={}));var o;(function(a){a.PROD="PROD",a.DEV="DEV",a.INTEGRATION="INTEGRATION",a.QA="TEST"})(o=e.EnvNames||(e.EnvNames={}));var i;(function(a){a.TBS="TBS",a.CNN="CNN",a.CartoonNetwork="CartoonNetwork",a.AdultSwim="AdultSwim",a.TNT="TNT",a.truTV="truTV",a.TCM="TCM",a.BR="BR",a.NCAA="NCAA",a.WMInternalEvents="WMInternalEvents",a.MML="MML",a.WMSpecialEvents="WMSpecialEvents",a.psmInvalidType="psmInvalidType"})(i=e.BrandsEnum||(e.BrandsEnum={}));var s;(function(a){a.ALL_ID="ALL_ID",a.ZERO_ID="ZERO_ID"})(s=e.COPPAPrivacyModesEnum||(e.COPPAPrivacyModesEnum={}))}}),Ds=ut({"../types/dist/payload.js"(e){"use strict";e.__esModule=!0}}),ks=ut({"../types/dist/psm.js"(e){"use strict";e.__esModule=!0}}),xs=ut({"../types/dist/telemetry.js"(e){"use strict";e.__esModule=!0}}),Ls=ut({"../types/dist/index.js"(e){"use strict";var r=e&&e.__createBinding||(Object.create?function(n,o,i,s){s===void 0&&(s=i);var a=Object.getOwnPropertyDescriptor(o,i);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,s,a)}:function(n,o,i,s){s===void 0&&(s=i),n[s]=o[i]}),t=e&&e.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&r(o,n,i)};e.__esModule=!0,t(Rs(),e),t(Ds(),e),t(ks(),e),t(xs(),e)}}),js={version:"1.1.5",psmProgramMap:{documentation:"keys under 'map' are 'map-from' values",players:[{playerName:"TOP2",map:{applicationName:{mapTo:"deviceCode",type:"String"},"tags.authRequired":{mapTo:"mvpd.authRequired",type:"Boolean"},"tags.authState":{mapTo:"mvpd.authState",type:"Boolean"},"tags.affiliate":{mapTo:"mvpd.mvpdDisplayName",type:"String"},"tags.mvpdId":{mapTo:"mvpd.mvpdId",type:"String"},"tags.appVersion":{mapTo:"productProperties.appVersion",type:"String"},"tags.episodeNumber":{mapTo:"video.assetEpisodeNumber",type:"String"},"tags.contentId":{mapTo:"video.assetId",type:"String"},assetName:{mapTo:"video.assetName",type:"String"},"tags.seasonNumber":{mapTo:"video.assetSeasonNumber",type:"String"},"tags.series":{mapTo:"video.assetSeries",type:"String"},"tags.contentType":{mapTo:"video.assetType",type:"String"},"tags.freePreview":{mapTo:"video.freePreview",type:"Boolean"},"tags.videoTitle":{mapTo:"video.fullTitle",type:"String"}}}]},psmDeviceMap:{documentation:"keys under 'map' are 'map-from' values",map:{brand:{mapTo:"brand",type:"String",enums:["TBS","CNN","Cartoon Network","Adult Swim","TNT","truTV","TCM","Bleacher Report","NCAA","WMInternalEvents","MML","WMSpecialEvents","prism"]},cdn:{mapTo:"cdn",type:"String"},customProperties:{mapTo:"customProperties",type:"String"},browserName:{mapTo:"device.browserName",type:"String"},browserVersion:{mapTo:"device.browserVersion",type:"String"},deviceBrand:{mapTo:"device.deviceBrand",type:"String"},deviceModel:{mapTo:"device.deviceModel",type:"String"},deviceOs:{mapTo:"device.deviceOs",type:"String"},deviceType:{mapTo:"device.deviceType",type:"String",enums:["Tablet","GamingConsole","CTV","Desktop","Phone","TV","MediaPlayer"]},osVersion:{mapTo:"device.osVersion",type:"String"},userAgent:{mapTo:"device.userAgent",type:"String"},deviceCode:{mapTo:"deviceCode",type:"String"},environment:{mapTo:"environment",type:"String",enums:["dev","qa","prod","integration"]},errorCode:{mapTo:"error.errorCode",type:"String"},errorMessage:{mapTo:"error.errorMessage",type:"String"},errorSeverity:{mapTo:"error.errorSeverity",type:"String"},eventId:{mapTo:"eventId",type:"String"},eventName:{mapTo:"eventName",type:"String"},eventTimestamp:{mapTo:"eventTimestamp",type:"String"},eventType:{mapTo:"eventType",type:"String",enums:["VideoQos","Identity","Privacy","Telemetry"]},cdpid:{mapTo:"ids.cdpid",type:"String"},psmSdkName:{mapTo:"library.name",type:"String",enums:["iOS","ReactNative","Android","PrismJS","Roku"]},psmSdkVersion:{mapTo:"library.version",type:"String"},city:{mapTo:"location.city",type:"String"},country:{mapTo:"location.country",type:"String"},state:{mapTo:"location.state",type:"String"},timezone:{mapTo:"location.timezone",type:"String"},referrer:{mapTo:"navigationProperties.referrer",type:"String"},rootDomain:{mapTo:"navigationProperties.rootDomain",type:"String"},networkConnectionType:{mapTo:"networkConnectionType",type:"String"},platform:{mapTo:"platform",type:"String",enums:["iOS","Android","FireTV","AndroidTV","Roku","Web","tvOS","Xbox","PlayStation","iPadOS"]},playerVendor:{mapTo:"player.playerVendor",type:"String"},playerVersion:{mapTo:"player.playerVersion",type:"String"},appVersion:{mapTo:"productProperties.appVersion",type:"String"},productName:{mapTo:"productProperties.productName",type:"String"},schemaVersionNumber:{mapTo:"schema.schemaVersionNumber",type:"String"},sentAtTimestamp:{mapTo:"sentAtTimestamp",type:"String"},sessionId:{mapTo:"session.sessionId",type:"String"},subBrand:{mapTo:"subBrand",type:"String"},assetIdType:{mapTo:"video.assetIdType",type:"String"},autoplay:{mapTo:"video.autoplay",type:"Boolean"},bitrate:{mapTo:"video.bitrate",type:"Integer"},currentMediaState:{mapTo:"video.currentMediaState",type:"String"},currentVideoPosition:{mapTo:"video.currentVideoPosition",type:"Integer"},liveStreamName:{mapTo:"video.liveStreamName",type:"String"},previousMediaState:{mapTo:"video.previousMediaState",type:"String"},previousVideoPosition:{mapTo:"video.previousVideoPosition",type:"Integer"},streamHost:{mapTo:"video.streamHost",type:"String"},streamType:{mapTo:"video.streamType",type:"String",enums:["Live","VOD"]},streamUrl:{mapTo:"video.streamUrl",type:"String"},videoDurationSec:{mapTo:"video.videoDurationSec",type:"Integer"},videoSessionId:{mapTo:"videoSession.videoSessionId",type:"String"},videoSessionStartTimestamp:{mapTo:"videoSession.videoSessionStartTimestamp",type:"String"},wmukid:{mapTo:"wmukid",type:"String"}}},eventMap:{adError:"adError",adFinished:"adFinished",adPaused:"adPaused",adResumed:"adResumed",adStarted:"adStarted",adStopped:"adStopped",contentBeginning:"contentBeginning",contentEnded:"contentEnded",contentError:"contentError",mediaBufferingFinished:"mediaBufferingFinished",mediaBufferingStarted:"mediaBufferingStarted",mediaError:"mediaError",mediaPaused:"mediaPaused",mediaResumed:"mediaResumed",mediaStarted:"mediaStarted",mediaStarting:"mediaStarting"},immediateEvents:["adError","contentEnded","contentError","mediaError","mediaStarted","mediaStarting","videoHeartbeat"],endingEvents:["contentEnded"],compressionIntervalMilliseconds:500,engagementEnvironment:{dev:"https://dev.receive.wmcdp.io/v1",integration:"https://test.receive.wmcdp.io/v1",prod:"https://receive.wmcdp.io/v1",qa:"https://test.receive.wmcdp.io/v1"},environment:{dev:"https://dev.video.wmcdp.io/v1/vid",integration:"https://qa.video.wmcdp.io/v1/vid",prod:"https://tlm.wmcdp.io/v1/vid",qa:"https://qa.video.wmcdp.io/v1/vid"},heartbeatIntervalSeconds:30},Ns="https://lightning.warnermediacdn.com/cdp/psm/schemas/video/qos/",Pn="program-map.top-2.json device-map.json event-map.top-2.json config.json",Us="https://lightning.warnermediacdn.com/cdp/psm/brands",Vs="https://dev.video.wmcdp.io/v1/vid",pr="5",Fs="psmClientInvalid:",qs="0.0.0",Cn="psm_test_polling_version_override",On="psmTelConfig",An=30,Bs=["contentCompleted","contentEnded"],Hs=["contentBeginning","mediaStarting","contentEnded"],Ws=class{constructor(e){this.version=e}async getAppendCDNrequest(e){let r=Ns+this.version+e;return await(await fetch(r)).json()}async refreshConfig(){let e=this.version;try{if(Pn)for(let r of Pn.split(" ")){let t="/"+r,n=await this.getAppendCDNrequest(t);this.default=P(P({},this.default),n)}return this.default.psmProgramMap===void 0||this.default.eventMap===void 0||this.default.environment===void 0||this.default.heartbeatIntervalSeconds===void 0||this.default.psmDeviceMap===void 0?null:te(P({},this.default),{version:e})}catch(r){return console.error("Error in refreshConfig",r.message),null}}},Ks=Ws,Gs=class{},re=class extends Gs{constructor(){super(),this.bundleConfig=js}static updateCurrentVersion(e){this.currentVersion=e}getLocalStorageConfig(){var e;let r=(e=M.dependencies)==null?void 0:e.getLocalStorage(On);switch(typeof r){case"string":re.activeConfig=r?JSON.parse(r):this.bundleConfig,re.updateCurrentVersion(re.activeConfig.version);break;case"object":r.then(t=>{re.activeConfig=t?JSON.parse(t):this.bundleConfig,re.updateCurrentVersion(re.activeConfig.version)});break;default:re.activeConfig=this.bundleConfig,re.updateCurrentVersion(re.activeConfig.version);break}}setLocalStorageConfig(e){M.dependencies.setLocalStorage(On,e)}async updateLocalStorageConfig(e){var r;if(((r=re.activeConfig)==null?void 0:r.version)===e)this.setLocalStorageConfig(re.activeConfig);else{let o=await new Ks(e).refreshConfig();o?this.setLocalStorageConfig(o):this.setLocalStorageConfig(re.activeConfig)}this.getLocalStorageConfig()}},gr=re;gr.currentVersion=qs;gr.responseProcessorConfig=[{code:201,handlerFunction:"Success"},{code:400,handlerFunction:"Failure"},{code:999,handlerFunction:"Retry"}];var q=gr,At=e=>e&&typeof e=="object"&&Object.prototype.toString.call(e)!=="[object RegExp]"&&Object.prototype.toString.call(e)!=="[object Date]",$s=e=>Array.isArray(e)?[]:{},ct=(e,r)=>r&&r.clone===!0&&At(e)?xe($s(e),e,r):e,Mn=(e,r,t)=>{let n=e.slice();return r.forEach(function(o,i){typeof n[i]>"u"?n[i]=ct(o,t):At(o)?n[i]=xe(e[i],o,t):e.indexOf(o)===-1&&n.push(ct(o,t))}),n},Js=(e,r,t)=>{let n={};return At(e)&&Object.keys(e).forEach(function(o){n[o]=ct(e[o],t)}),Object.keys(r).forEach(function(o){!At(r[o])||!e[o]?n[o]=ct(r[o],t):n[o]=xe(e[o],r[o],t)}),n},xe=(e,r,t)=>{let n=Array.isArray(r),i=(t||{arrayMerge:Mn}).arrayMerge||Mn;return n?Array.isArray(e)?i(e,r,t):ct(r,t):Js(e,r,t)},X=(...e)=>{var r;(r=M.dependencies)!=null&&r.debugModeEnabled&&console.log("=========================>>> PSM:",...e)},Qs=(e,r,t,n,o)=>{let i=r.split("."),s=i.length,a=e,c=ea(t,n,o);for(let d=0;d<s;d++)if(d<s-1){let u=a[i[d]]?a[i[d]]:{};a[i[d]]=u,a=u}else a[i[d]]=c,a=c},zs=e=>Object.keys(e),jn=e=>e*1e3,Ys=()=>{let e=M.psm.getConfig().psmEnvironment.toUpperCase(),r=q.activeConfig.environment,t;switch(e){case"DEV":t=r.dev;break;case"TEST":t=r.qa;break;case"INTEGRATION":t=r.integration;break;case"PROD":t=r.prod;break}return t||Vs},Zs=e=>{let r;switch(e){case"DEV":r="dev";break;case"TEST":r="qa";break;case"INTEGRATION":r="integration";break;case"PROD":r="prod";break}return r||e};function Rn(e){return e!=null&&typeof e=="object"&&typeof e<"u"&&!Array.isArray(e)}function Nn(e,r){if(typeof e>"u")return!1;let t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(r);if(t.length!=n.length)return!1;for(let o in t){let i=e[t[o]],s=r[t[o]],a=Rn(i)&&Rn(s);if(a&&!Nn(i,s)||!a&&i!==s)return!1}return!0}function Xs(e,r){return r.split(".").reduce((t,n)=>t&&t[n]!=="undefined"?t[n]:void 0,e)}function Un(e,r){let t={},n=Object.keys(r);for(let o of n){let i=Xs(e,o),{mapTo:s,type:a,enums:c=null}=r[o];Qs(t,s,i,a,c)}return Object.assign({},t)}function ea(e,r,t){let n=null;if(e===null||typeof e>"u"||typeof e=="string"&&e.length===0)return null;switch(r){case"String":t&&t.length>0&&typeof e=="string"?n=Dn(e,r,t):typeof e=="string"&&e.length>0&&!t&&(n=e);break;case"Integer":t&&t.length>0&&typeof e=="number"?n=Dn(e,r,t):typeof e=="number"&&!t&&(n=Math.trunc(e));break;case"Boolean":typeof e=="boolean"&&(n=e);break;default:break}return n}function Vn(e){return Object.entries(e).forEach(([r,t])=>{t&&typeof t=="object"&&Vn(t),(t&&typeof t=="object"&&!Object.keys(t).length||t===null)&&delete e[r]}),e}function Dn(e,r,t){let n=!1;if(r==="String")return typeof e=="string"&&t.findIndex(i=>e.toLowerCase()===i.toString().toLowerCase())!==-1&&e.length>0?e.toLowerCase():Fs+e;if(r==="Integer")return n=typeof e=="number"&&!isNaN(e)&&t.findIndex(o=>e===o)!==-1,n?e:null}var ta=class{constructor(){this.baseURL=Us,this.currentPsmTelRollout=null,this.versionPath=M.dependencies.getVersionPath();let e=M.psm.getBrandToken();this.brandToken=e?e.toLowerCase():M.psm.getBrand().toLowerCase()}async getAndCheckPsmMgrConfigCDN(){let e=`${this.baseURL}/${this.brandToken}/${this.versionPath}/psm.json`;try{let t=await(await fetch(e,{cache:"no-cache"})).json();return Nn(this.psmMgrConfig,t)?!1:(this.psmMgrConfig=t,!0)}catch(r){return console.error("Error in getting Prism Manager Config = error message:",r.message),!0}}getThrottleFlag(){var o;var e,r,t,n;if(this.currentPsmTelRollout===null||this.currentPsmTelRollout!==((r=(e=this.psmMgrConfig)==null?void 0:e.psmRolloutPercentages)==null?void 0:r.psmTel)){let i=parseInt(Date.now().toString().slice(-2));return this.currentPsmTelRollout=(o=(n=(t=this.psmMgrConfig)==null?void 0:t.psmRolloutPercentages)==null?void 0:n.psmTel)!=null?o:100,!(this.currentPsmTelRollout>=i||this.currentPsmTelRollout===100)}else return M.isThrottled}},ra=ta,na=class{constructor(e,r=An){this.setIntervalInMilliseconds=function(t){this.interval=jn(t)},this.callback=e,this.setIntervalInMilliseconds(r||An),this.isTimerRunning=!1}start(){return this.timer=setInterval(this.callback,this.interval),this.isTimerRunning=!0,this.timer}stop(){return clearInterval(this.timer),this.isTimerRunning=!1,this.timer=null,this.timer}reset(){return this.stop(),this.start()}updateInterval(e){return this.setIntervalInMilliseconds(e),this.reset()}},Fn=na,oa=class{constructor(e){var r;this.initWMUKID(),this.playerDependencies=e;let{brand:t,subBrand:n,platform:o,psmEnvironment:i,productName:s}=M.psm.getConfig();this.brand=t||null,this.subBrand=n||null,this.platform=o||null,this.environment=Zs(i)||null,this.schemaVersionNumber=q.currentVersion,this.sessionId=(r=M.psm.getSessionProperties())==null?void 0:r.sessionid,this.productName=s||this.subBrand,this.networkConnectionType=M.dependencies.networkConnectionType,this.setRootLevelProperties(this.setLibraryProperties),this.setRootLevelProperties(this.setLocationProperties),this.setRootLevelProperties(this.setPlayerProperties.bind(this))}mappingMetadata(e,r,t){let n=r.players.find(i=>i.playerName===t.playerVendor);return Un(e,n.map)}initWMUKID(){function e(r){this.wmukid=r}M.dependencies.getWMUKID(e.bind(this))}setRootLevelProperties(e){Object.assign(this,e())}setLocationProperties(){let e=M.psm.getLocationProperties();return{city:(e==null?void 0:e.city)||null,state:(e==null?void 0:e.state)||null,country:(e==null?void 0:e.country)||null,timezone:(e==null?void 0:e.timezone)||null}}setLibraryProperties(){let e=M.psm.getLibrary();return{psmSdkName:(e==null?void 0:e.name.replace(" ",""))||null,psmSdkVersion:(e==null?void 0:e.version)||null}}setPlayerProperties(){return{playerVendor:this.playerDependencies.playerVendor}}},qn=oa;async function ia(e,r){let t={method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer-when-downgrade",body:JSON.stringify(r)};return await fetch(e,t)}var sa=class{constructor(){}handleResponse(e,r){X("Response Status Code: ",e.status);let n=q.responseProcessorConfig.find(o=>o.code===e.status);this.callHandler(n.handlerFunction,r)}callHandler(e,r){switch(e){case"Success":this.handleSuccess(r);break;case"Failure":this.handleFailure(r);break;case"Retry":this.handleRetry();break}}handleSuccess(e){X("success"),e.clearDispatchQueue()}handleFailure(e){X("failure"),e.clearDispatchQueue()}handleRetry(){X("retry")}},aa=sa,da=["","US","GU","AS","PR","VI","MH","UM","MP"],ca=class{constructor(e){this.eventBuilder=e,this.dispatchQueue=[],this.locationAccepted=da.indexOf(M.psm.getLocationProperties().country)>0}async sendEvents(){if(X("event sender triggered"),this.dispatchQueue=this.getDispatchQueue(),this.dispatchQueue.length>0&&!M.isThrottlingRequested&&this.locationAccepted){X("sending dispatch queue");let e=Ys(),r=await ia(e,this.dispatchQueue);new aa().handleResponse(r,this)}else this.dispatchQueue.length>0&&M.isThrottlingRequested||!this.locationAccepted?(X("clearing dispatch queue"),this.clearDispatchQueue()):X("dispatch queue is empty")}getDispatchQueue(){let e=new Date().toISOString();return this.eventBuilder.getEventQueue().map(n=>Object.assign({},n,{sentAtTimestamp:e}))}clearDispatchQueue(){this.dispatchQueue=[]}},la=ca,lt=class{constructor(){}},Mt=lt;Mt.queuedEvents=[];Mt.updateQueue=function(e){if(Object.keys(e).length>0){let r=xe({},e),t=Vn(r);lt.queuedEvents.push(t),X("QueuedEvents cleaned and validated --->",lt.queuedEvents)}};Mt.retrieveQueue=function(){let e=xe([],lt.queuedEvents);return lt.queuedEvents=[],e};var fr=Mt,kn=()=>pe(),ua=class{constructor(e){this.eventCount=0,this.playerState={video:{}},this.isAdPaused=!1,this.getEventQueue=function(){return fr.queuedEvents.length===0&&this.buildHeartbeatEvent(),fr.retrieveQueue()},this.buildHeartbeatEvent=function(){let o=this.getVideoStateAttribute("currentMediaState");(o==="playing"||o==="pending")&&!this.isAdPaused&&this.queuePsmVidEvent("videoHeartbeat")};var r;this.bridge=e,this.eventSender=new la(this);let t=(r=q.activeConfig)==null?void 0:r.heartbeatIntervalSeconds,n=()=>this.eventSender.sendEvents();this.heartbeatTimer=new Fn(n,t),this.currentVersion=q.currentVersion,this.videoSessionId=kn(),this.videoSessionStartTimestamp=new Date().toISOString()}getVideoStateAttribute(e){return this.playerState.video[e]}setVideoStateAttributes(e,r){this.playerState.video[e]=r}clearVideoSession(){this.videoSessionId=null,this.videoSessionStartTimestamp=null}setDeviceMapping(e){var r,t,n;return Un(e,(n=(t=(r=q)==null?void 0:r.activeConfig)==null?void 0:t.psmDeviceMap)==null?void 0:n.map)}generateVideoSession(){this.videoSessionId=kn(),this.videoSessionStartTimestamp=new Date().toISOString()}queuePsmVidEvent(e){var r,t,n,o,i,s,a,c;if(M.isThrottlingRequested)return;let d={};if(this.currentVersion!==q.currentVersion){let l=(r=q.activeConfig)==null?void 0:r.heartbeatIntervalSeconds;this.heartbeatTimer.interval!==l&&this.heartbeatTimer.updateInterval(l),this.currentVersion=q.currentVersion}if(this.heartbeatTimer.isTimerRunning||this.heartbeatTimer.start(),e==="adPaused"?this.isAdPaused=!0:e==="adResumed"?this.isAdPaused=!1:this.playerState.video.currentMediaState==="playing"&&(this.isAdPaused=!1),this.videoSessionId||this.generateVideoSession(),d.videoSessionId=this.videoSessionId,d.videoSessionStartTimestamp=this.videoSessionStartTimestamp,d.eventName=e,d.eventId=this.videoSessionId+"-"+ ++this.eventCount,d.eventType="VideoQos",d.eventTimestamp=new Date().toISOString(),d.cdn=this.bridge.playerDependencies.getCDN(),d.bitrate=this.playerState.video.bitrate,d.videoDurationSec=this.bridge.playerDependencies.getVideoDurationSec(),d.streamHost=this.bridge.playerDependencies.getStreamHost(),d.streamUrl=this.bridge.playerDependencies.getStreamUrl(),d.autoplay=this.bridge.playerDependencies.getAutoplay(),d.streamType=Hs.includes(e)?null:this.bridge.playerDependencies.getStreamType(),d.liveStreamName=d.streamType==="Live"?this.bridge.playerDependencies.getLiveStreamName():null,typeof(d==null?void 0:d.previousMediaState)>"u"){let l=this.playerState.video.previousMediaState||this.playerState.video.currentMediaState||this.bridge.playerDependencies.currentMediaState()||null;d.previousMediaState=l}if(typeof(d==null?void 0:d.currentMediaState)>"u"){let l=this.playerState.video.currentMediaState||this.bridge.playerDependencies.currentMediaState()||null;d.currentMediaState=l}if(typeof(d==null?void 0:d.previousVideoPosition)>"u"||((n=(t=this.playerState)==null?void 0:t.video)==null?void 0:n.previousVideoPosition)===-1){let l=this.playerState.video.previousVideoPosition||this.bridge.playerDependencies.currentVideoPosition()||null;d.previousVideoPosition=l}if(typeof(d==null?void 0:d.currentVideoPosition)>"u"||((i=(o=this.playerState)==null?void 0:o.video)==null?void 0:i.currentVideoPosition)===-1){let l=this.bridge.playerDependencies.currentVideoPosition()||null;d.currentVideoPosition=l}(a=(s=this.playerState)==null?void 0:s.error)!=null&&a.errorCode&&(d.errorSeverity=this.playerState.error.errorSeverity,d.errorCode=this.playerState.error.errorCode,d.errorMessage=this.playerState.error.errorMessage),d=xe(d,this.bridge.psmMetadata),d=this.setDeviceMapping(d),this.bridge.mappedProgramMetadata&&(d=xe(d,this.bridge.mappedProgramMetadata)),fr.updateQueue(d),((c=q.activeConfig)==null?void 0:c.immediateEvents.includes(e))&&e!=="videoHeartbeat"&&this.eventSender.sendEvents()}setVideoError(e){var r,t,n;this.playerState.error={errorSeverity:((r=e==null?void 0:e.error)==null?void 0:r._severity)||null,errorCode:((t=e==null?void 0:e.error)==null?void 0:t._code)||null,errorMessage:((n=e==null?void 0:e.error)==null?void 0:n._message)||null}}},pa=ua,Ae=class{constructor(e,r,t,n,o){this.psmProgramMetadata={},this.isBridgeInitialized=!1,this.mappedProgramMetadata={},Ae.dependencies=t,this.playerDependencies=n,this.metadataDependencies=o,Ae.psm=r,this.videoPlayer=e,this.metadata=new qn(n),this.psmActiveConfig=new q,this.psmProductConfig=new ra,this.setConfig(),this.eventBuilder=new pa(this);let i=s=>{this.eventBuilder.queuePsmVidEvent(s)};this.videoPlayer.activateListeners(this.eventBuilder,i)}async setConfig(){var e,r;let t=await this.psmProductConfig.getAndCheckPsmMgrConfigCDN();await this.psmActiveConfig.getLocalStorageConfig();let n=(r=(e=this.psmProductConfig)==null?void 0:e.psmMgrConfig)==null?void 0:r.psmTelSchemaVersion,o=q.currentVersion===n;if(t||!o){this.pollingTimer||this.setPollingTimerForThrottling(),this.pollingTimer.interval!==jn(+pr*60)&&this.pollingTimer.updateInterval(+pr*60);let i=!o&&t;if(!this.isBridgeInitialized||i){let s=n||q.activeConfig.version;await this.psmActiveConfig.updateLocalStorageConfig(s),this.updateProgramMapStructure(q.activeConfig.psmProgramMap),this.isBridgeInitialized=!0}this.setMetadataListener(q.activeConfig.psmProgramMap),this.setEventsToMonitor(q.activeConfig.eventMap)}this.updateThrottling()}setEventsToMonitor(e){Ae.psmActiveConfigEvents=zs(e)}updateProgramMapStructure(e){let r=this.videoPlayer.asyncMetadata.unmapped;this.mappedProgramMetadata=this.metadata.mappingMetadata(r,e,this.playerDependencies)}setMetadataListener(e){this.psmMetadata=this.metadataDependencies.getMetadata(this.playerDependencies);let r=this,t={set(n,o,i){return o==="unmapped"&&(r.mappedProgramMetadata=r.metadata.mappingMetadata(i,e,r.playerDependencies)),n[o]=i}};this.videoPlayer.asyncMetadata=new Proxy(this.psmProgramMetadata,t)}updateThrottling(){Ae.isThrottlingRequested=this.psmProductConfig.getThrottleFlag(),Ae.isThrottled=Ae.isThrottlingRequested,X("Events are Throttling now?",Ae.isThrottlingRequested)}setPollingTimerForThrottling(){this.pollingTimer=new Fn(this.setConfig.bind(this),+pr*60),this.pollingTimer.start()}},Bn=Ae;Bn.isThrottled=!1;var M=Bn,fa=class{constructor(e){this.player=e,this.asyncMetadata={unmapped:{},isLoaded:!1}}activateListeners(e,r){var t,n;(n=(t=this.player)==null?void 0:t.events)==null||n.listen((o,i)=>{var s,a,c,d;if(this.setCurrentVideoAttributes(o,i,e),(s=M.psmActiveConfigEvents)!=null&&s.includes(o)&&r(o),o==="modelUpdated")if(this.player.config.analytics.conviva&&!this.asyncMetadata.isLoaded)this.asyncMetadata.unmapped=this.player.config.analytics.conviva,this.asyncMetadata.isLoaded=!0;else for(let l of i.changed)l.property==="config"&&(this.asyncMetadata.unmapped=(c=(a=l.currentValue)==null?void 0:a.analytics)==null?void 0:c.conviva);((d=q.activeConfig)!=null&&d.endingEvents?q.activeConfig.endingEvents:Bs).includes(o)&&(e.clearVideoSession(),e.heartbeatTimer.stop())})}clearError(e,r){var t,n;e.indexOf("Error")===-1&&((n=(t=r==null?void 0:r.playerState)==null?void 0:t.error)==null?void 0:n.errorCode)&&(delete r.playerState.error.errorCode,delete r.playerState.error.errorSeverity,delete r.playerState.error.errorMessage)}setCurrentVideoAttributes(e,r,t){switch(this.clearError(e,t),e){case"adError":case"contentError":case"mediaError":case"playerError":t.setVideoError(r);break;case"mediaStateChanged":let n=t.getVideoStateAttribute("currentVideoPosition")||0;t.setVideoStateAttributes("currentMediaState",r.currentState),t.setVideoStateAttributes("previousMediaState",r.previousState),t.setVideoStateAttributes("previousVideoPosition",n),t.setVideoStateAttributes("currentVideoPosition",this.player.model.mediaTime);break;case"mediaProfileChanged":t.setVideoStateAttributes("bitrate",r.profile.bitrate);break;default:break}}},ga=fa,ma=e=>{let{model:r,config:t}=e;return{playerInstance:e,playerVendor:"TOP2",getCDN:()=>{var n,o,i;return(i=(o=(n=r.playlistItem)==null?void 0:n.entry)==null?void 0:o.metadata)==null?void 0:i.cdnType},currentVideoPosition:()=>r.mediaTime,currentMediaState:()=>r.mediaState,getVideoDurationSec:()=>r.mediaDuration,getStreamHost:()=>{var n,o;return(o=(n=r.config)==null?void 0:n.metadata)==null?void 0:o.cdnHost},getStreamUrl:()=>{var n,o,i,s;return(s=(i=(o=(n=r.playlistItem)==null?void 0:n.entry)==null?void 0:o.files)==null?void 0:i[0])==null?void 0:s.url},getAutoplay:()=>{var n;return(n=t.playback)==null?void 0:n.autoPlay},getStreamType:()=>r.contentIsLive?"Live":"VOD",getLiveStreamName:()=>{var n,o;return(o=(n=r.playlistItem)==null?void 0:n.entry)==null?void 0:o.id}}},ha=class{constructor(e){this.player=e}sendPsmEvent(e){X("discovery sendPsmEvent ----",e)}sendMetadataMap(e){}activateListeners(e,r){var t,n;(n=(t=this.player)==null?void 0:t.events)==null||n.listen((o,i)=>{r!=null&&r.includes(o)&&(X(`==> ${o} is the key in EventMap <==`),X(`==> ${i} is the result from event <==`))})}},va=ha,ya=e=>{var r,t,n;let{model:o,config:i}=e;return{playerVendor:"DiscoveryPlayer",playerVersion:(n=(t=(r=window.TOP)==null?void 0:r.Player)==null?void 0:t.Version)==null?void 0:n.libVersion,getCDN:()=>{var s,a,c;return(c=(a=(s=o.playlistItem)==null?void 0:s.entry)==null?void 0:a.metadata)==null?void 0:c.cdnType},currentVideoPosition:()=>o.mediaTime,currentMediaState:()=>o.mediaState,getVideoDurationSec:()=>o.mediaDuration,getStreamHost:()=>{var s,a;return(a=(s=o.config)==null?void 0:s.metadata)==null?void 0:a.cdnHost},getStreamUrl:()=>{var s,a,c,d;return(d=(c=(a=(s=o.playlistItem)==null?void 0:s.entry)==null?void 0:a.files)==null?void 0:c[0])==null?void 0:d.url},getAutoplay:()=>{var s;return(s=i.playback)==null?void 0:s.autoPlay},getStreamType:()=>o.contentIsLive?"Live":"VOD",getLiveStreamName:()=>{var s,a;return(a=(s=o.playlistItem)==null?void 0:s.entry)==null?void 0:a.id}}},Sa=()=>{let{navigator:e}=window,r=e.userAgent,t=e.appName,n=""+parseFloat(e.appVersion),o=parseInt(e.appVersion,10),i,s,a;return(s=r.indexOf("Opera"))!=-1?(t="Opera",n=r.substring(s+6),(s=r.indexOf("Version"))!=-1&&(n=r.substring(s+8))):(s=r.indexOf("MSIE"))!=-1?(t="Microsoft Internet Explorer",n=r.substring(s+5)):t=="Netscape"&&r.indexOf("Trident/")!=-1?(t="Microsoft Internet Explorer",n=r.substring(s+5),(s=r.indexOf("rv:"))!=-1&&(n=r.substring(s+3))):(s=r.indexOf("Chrome"))!=-1?(t="Chrome",n=r.substring(s+7)):(s=r.indexOf("Safari"))!=-1?(t="Safari",n=r.substring(s+7),(s=r.indexOf("Version"))!=-1&&(n=r.substring(s+8)),r.indexOf("CriOS")!=-1&&(t="Chrome")):(s=r.indexOf("Firefox"))!=-1?(t="Firefox",n=r.substring(s+8)):(i=r.lastIndexOf(" ")+1)<(s=r.lastIndexOf("/"))&&(t=r.substring(i,s),n=r.substring(s+1),t.toLowerCase()==t.toUpperCase()&&(t=e.appName)),(a=n.indexOf(";"))!=-1&&(n=n.substring(0,a)),(a=n.indexOf(" "))!=-1&&(n=n.substring(0,a)),(a=n.indexOf(")"))!=-1&&(n=n.substring(0,a)),o=parseInt(""+n,10),isNaN(o)&&(n=""+parseFloat(e.appVersion),o=parseInt(e.appVersion,10)),{browserName:t,browserMajorVersion:o.toString()}},_a=class extends qn{constructor(e){var r,t,n;super(e),super.setRootLevelProperties(this.setIdProperties.bind(this)),super.setRootLevelProperties(this.setDeviceProperties.bind(this)),super.setRootLevelProperties(this.setNavigationProperties.bind(this)),this.playerVersion=(n=(t=(r=window.TOP)==null?void 0:r.Player)==null?void 0:t.Version)==null?void 0:n.libVersion}setIdProperties(){let e=M.psm.getIds();return this.deviceSpecificMetadata=te(P({},this.deviceSpecificMetadata),{cdpid:e==null?void 0:e.cdpid}),this.deviceSpecificMetadata}setDeviceProperties(){let e=M.psm.getDeviceProperties(),r=Sa();return this.deviceSpecificMetadata=te(P({},this.deviceSpecificMetadata),{browserName:(r==null?void 0:r.browserName)||null,browserVersion:(r==null?void 0:r.browserMajorVersion)||null,userAgent:(e==null?void 0:e.userAgent)||null}),this.deviceSpecificMetadata}setNavigationProperties(){let e=M.psm.getNavigationProperties();return this.deviceSpecificMetadata=te(P({},this.deviceSpecificMetadata),{referrer:(e==null?void 0:e.referrer)||null,rootDomain:(e==null?void 0:e.rootDomain)||null}),this.deviceSpecificMetadata}},Hn=_a,ba=Ms(Ls()),Wn=e=>{var r,t,n;return{getVersionPath:()=>{var o,i,s,a;let c=new Proxy(new URLSearchParams((o=window==null?void 0:window.location)==null?void 0:o.search),{get:(p,f)=>p.get(f)});if(c[Cn])return`webapp/${c[Cn]}`;let u=((i=e.getConfig())==null?void 0:i.psmEnvironment)===ba.EnvNames.PROD?"release":"pre",l=(a=(s=e.getConfig())==null?void 0:s.pollingVersion)==null?void 0:a.split("/")[2];return`webapp/web/${u}/${l}`},getLocalStorage:o=>{var i;return(i=window.localStorage.getItem(o))!=null?i:""},debugModeEnabled:typeof((r=window.psmMgr)==null?void 0:r.psm_test_ts)<"u"&&((t=window.psmMgr)==null?void 0:t.psm_test_ts),setLocalStorage:(o,i)=>{window.localStorage.setItem(o,JSON.stringify(i))},networkConnectionType:(n=window.navigator.connection)==null?void 0:n.effectiveType,getWMUKID:o=>{o(M.psm.getWMUKID())}}},wa=class extends M{constructor(e,r){X("Testing Multiple Players");let t=new ga(e),n=Wn(r),o=ma(t.player),i={getMetadata:s=>new Hn(s)};super(t,r,n,o,i)}},Ta=class extends M{constructor(e,r){let t=new va(e),n=Wn(r),o=ya(t.player),i={getMetadata:s=>new Hn(s)};super(t,r,n,o,i)}},Kn=Ta,Gn=wa;var We={name:"@turnercode/cdp-psm-core",version:"3.3.0",description:"Prism core functions",private:!0,main:"dist/psm.legacy.min.umd.cjs",module:"dist/psm.legacy.min.umd.mjs",exports:{".":{import:"./dist/psm.legacy.min.umd.mjs",require:"./dist/psm.legacy.min.umd.cjs"},"./web":{import:"./dist/psm.legacy.min.umd.mjs",require:"./dist/psm.legacy.min.umd.cjs"},"./rn":{import:"./dist/psm-rn.mjs",require:"./dist/psm-rn.cjs"},"./src/*":"./src/*","./package.json":"./package.json"},repository:{type:"git",url:"https://github.com/turnercode/cdp.git",directory:"packages/psm-core"},author:"The CDP Development Team <CDP-TECH-TEAM@warnermedia.com>",license:"UNLICENSED",scripts:{build:"tsup --minify",clean:"rm -rf .turbo && rm -rf node_modules && rm -rf dist",lint:"TIMING=1 eslint src --fix",test:"jest"},devDependencies:{"@iabtcf/cmpapi":"^1.5.3","@iabtcf/core":"^1.5.3","@segment/localstorage-retry":"^1.3.0","@turnercode/cdp-cookie":"workspace:*","@turnercode/cdp-feature-flag-client":"workspace:*","@turnercode/cdp-prism-module-telemetry":"workspace:*","@turnercode/eslint-config-cdp":"workspace:*","@turnercode/scripts":"workspace:*","@turnercode/tsconfig":"workspace:*","@turnercode/types":"workspace:*",tsup:"^6.1.3",uuid:"^8.3.2"},jest:{preset:"@turnercode/scripts/jest/node",testEnvironment:"jsdom"}};var A={lightningOrigin:"https://lightning.warnermediacdn.com",iFramePath:{DEV:"/cdptest/psmtk/getcdpid.html",TEST:"/cdptest/psmtk/getcdpid.html",PROD:"/cdp/psmtk/getcdpid.html",INTEGRATION:"/cdptest/psmtk/getcdpid.html",AUTOMATED_TEST:"/cdptest/psmtk/getcdpid.html"},thirdPartyCookie:"/cdp/psmtk/start.html",carouselScript:"/cdp/psm/assets/swiper/swiper-bundle.min.js",carouselStyles:"/cdp/psm/assets/swiper/swiper-bundle.min.css",locate:"https://geo.ngtv.io/locate",featureFlag:{DEV:"https://wmff.warnermediacdn.com/psm_2_dev_full.json",TEST:"https://wmff.warnermediacdn.com/psm_2_qa_full.json",PROD:"https://wmff.warnermediacdn.com/psm_2_prod_full.json",INTEGRATION:"https://wmff.warnermediacdn.com/psm_2_brand_integration_full.json",AUTOMATED_TEST:"https://wmff.warnermediacdn.com/psm_2_automated_test_full.json"},identity:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},inbrain:{LOCAL:"http://localhost:8080/v1/render",DEV:"https://dev.inbrain.wmcdp.io/v1/render",TEST:"https://test.inbrain.wmcdp.io/v1/render",PROD:"https://inbrain.wmcdp.io/v1/render",INTEGRATION:"https://test.inbrain.wmcdp.io/v1/render",AUTOMATED_TEST:"https://test.inbrain.wmcdp.io/v1/render"},idresolve:{DEV:"https://dev.psm.wmcdp.io/v1/resolve",TEST:"https://test.psm.wmcdp.io/v1/resolve",PROD:"https://psm.wmcdp.io/v1/resolve",INTEGRATION:"https://integration.psm.wmcdp.io/v1/resolve",AUTOMATED_TEST:"https://test.psm.wmcdp.io/v1/resolve"},logs:{DEV:"https://dev.receive.wmcdp.io/v1/reg",TEST:"https://test.receive.wmcdp.io/v1/reg",PROD:"https://receive.wmcdp.io/v1/reg",INTEGRATION:"https://test.receive.wmcdp.io/v1/reg",AUTOMATED_TEST:"https://test.receive.wmcdp.io/v1/reg"},authSvc:{DEV:"https://dev.token.wmcdp.io/v1/token",TEST:"https://test.token.wmcdp.io/v1/token",PROD:"https://token.wmcdp.io/v1/token",INTEGRATION:"https://test.token.wmcdp.io/v1/token",AUTOMATED_TEST:"https://test.token.wmcdp.io/v1/token"}},Ke=["","US","GU","AS","PR","VI","MH","UM","MP"];var $n={"auth-service":!1,"doppler-identity-onstart":!0,"doppler-identity-oncomplete":!0,"doppler-session":!0,"doppler-privacy":!0,"doppler-telemetry":!0,"doppler-consent-update":!0,"doppler-heartbeat-event":!1,"doppler-pubsub-event":!1,"outside-us-location-check":!1,"doppler-send-logs":!0,"doppler-send-token-event":!1,idresolve:!1,sendAuthToken:!1,sendHHID:!1,inbrain:!1,isInAuthTokenExperiment:!1,isInHHIDExperiment:!1,sendWMSegs:!1,inBrainTemplateBeta:!1,inBrainRecommendationsBeta:!1,"test-enabled":!0,"test-disabled":!1},Rt={minRetryDelay:3e4,maxRetryDelay:12e4,maxItems:5,maxAttempts:10,backoffFactor:2,backoffJitter:0};var mr=class{constructor(){this.ready=!1;this.config={platform:"web",brand:"",psmBrandToken:"",subBrand:"",productName:"",psmEnvironment:void 0,psmTelEnabled:!0};this.consentRule="Other";this.flags=[];this.location={asn:{id:"",name:""},continent:"",continentName:"",country:"",country_alpha2:"",country_alpha3:"",ip_address:"",lat:"",lon:"",proxy:null,states:[{cities:[],counties:[],state:"",zipcodes:[]}]};this.timezone=null;this.wmukid="Unknown";this.cdpid=null}getVersion(){return We.version}getConfig(){return this.config}getBrand(){return this.config.brand}getBrandToken(){return this.config.psmBrandToken}getSubBrand(){return this.config.subBrand}getCoppaPrivacyMode(){return this.coppaPrivacyMode}getCoreWMUKID(){return this.wmukid}setCoreWMUKID(r){this.wmukid=r}getSessionProperties(){return this.session}validateConfig(r){let t=[];if(this.hasProperty("psmEnvironment",r)||t.push("Please specify your psmEnvironment."),this.hasProperty("brand",r)||t.push("Please specify your brand."),t.length)throw new Error(["[PSM]: Invalid configuration provided."].concat(t).join(`
`))}hasProperty(r,t){return Object.prototype.hasOwnProperty.call(t,r)}getLocationProperties(){return{city:this.location.states[0].cities[0],state:this.location.states[0].state,country:this.location.country,zip:this.location.states[0].zipcodes[0],timezone:this.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone,locale:"locale",language:"language"}}initCoppaPrivacyMode(){var n;let r="ALL_ID";Ke.includes(this.getLocationProperties().country)?(n=this.config)!=null&&n.privacyMode&&(r=this.config.privacyMode):r="ZERO_ID",this.coppaPrivacyMode=r}},Qn=mr;He();var Ea=Object.create,Zn=Object.defineProperty,Pa=Object.getOwnPropertyDescriptor,Xn=Object.getOwnPropertyNames,Ca=Object.getPrototypeOf,Oa=Object.prototype.hasOwnProperty,Ge=(e,r)=>function(){return r||(0,e[Xn(e)[0]])((r={exports:{}}).exports,r),r.exports},Aa=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Xn(r))!Oa.call(e,o)&&o!==t&&Zn(e,o,{get:()=>r[o],enumerable:!(n=Pa(r,o))||n.enumerable});return e},Ma=(e,r,t)=>(t=e!=null?Ea(Ca(e)):{},Aa(r||!e||!e.__esModule?Zn(t,"default",{value:e,enumerable:!0}):t,e)),Ra=Ge({"../../node_modules/.pnpm/component-url@0.2.1/node_modules/component-url/index.js"(e){e.parse=function(t){var n=document.createElement("a");return n.href=t,{href:n.href,host:n.host||location.host,port:n.port==="0"||n.port===""?r(n.protocol):n.port,hash:n.hash,hostname:n.hostname||location.hostname,pathname:n.pathname.charAt(0)!="/"?"/"+n.pathname:n.pathname,protocol:!n.protocol||n.protocol==":"?location.protocol:n.protocol,search:n.search,query:n.search.slice(1)}},e.isAbsolute=function(t){return t.indexOf("//")==0||!!~t.indexOf("://")},e.isRelative=function(t){return!e.isAbsolute(t)},e.isCrossDomain=function(t){t=e.parse(t);var n=e.parse(window.location.href);return t.hostname!==n.hostname||t.port!==n.port||t.protocol!==n.protocol};function r(t){switch(t){case"http:":return 80;case"https:":return 443;default:return location.port}}}}),Da=Ge({"../../node_modules/.pnpm/ms@2.0.0/node_modules/ms/index.js"(e,r){var t=1e3,n=t*60,o=n*60,i=o*24,s=i*365.25;r.exports=function(l,p){p=p||{};var f=typeof l;if(f==="string"&&l.length>0)return a(l);if(f==="number"&&isNaN(l)===!1)return p.long?d(l):c(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function a(l){if(l=String(l),!(l.length>100)){var p=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(l);if(!!p){var f=parseFloat(p[1]),g=(p[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return f*s;case"days":case"day":case"d":return f*i;case"hours":case"hour":case"hrs":case"hr":case"h":return f*o;case"minutes":case"minute":case"mins":case"min":case"m":return f*n;case"seconds":case"second":case"secs":case"sec":case"s":return f*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function c(l){return l>=i?Math.round(l/i)+"d":l>=o?Math.round(l/o)+"h":l>=n?Math.round(l/n)+"m":l>=t?Math.round(l/t)+"s":l+"ms"}function d(l){return u(l,i,"day")||u(l,o,"hour")||u(l,n,"minute")||u(l,t,"second")||l+" ms"}function u(l,p,f){if(!(l<p))return l<p*1.5?Math.floor(l/p)+" "+f:Math.ceil(l/p)+" "+f+"s"}}}),ka=Ge({"../../node_modules/.pnpm/debug@2.6.9/node_modules/debug/src/debug.js"(e,r){e=r.exports=o.debug=o.default=o,e.coerce=c,e.disable=s,e.enable=i,e.enabled=a,e.humanize=Da(),e.names=[],e.skips=[],e.formatters={};var t;function n(d){var u=0,l;for(l in d)u=(u<<5)-u+d.charCodeAt(l),u|=0;return e.colors[Math.abs(u)%e.colors.length]}function o(d){function u(){if(!!u.enabled){var l=u,p=+new Date,f=p-(t||p);l.diff=f,l.prev=t,l.curr=p,t=p;for(var g=new Array(arguments.length),m=0;m<g.length;m++)g[m]=arguments[m];g[0]=e.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var h=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(w,b){if(w==="%%")return w;h++;var T=e.formatters[b];if(typeof T=="function"){var E=g[h];w=T.call(l,E),g.splice(h,1),h--}return w}),e.formatArgs.call(l,g);var y=u.log||e.log||console.log.bind(console);y.apply(l,g)}}return u.namespace=d,u.enabled=e.enabled(d),u.useColors=e.useColors(),u.color=n(d),typeof e.init=="function"&&e.init(u),u}function i(d){e.save(d),e.names=[],e.skips=[];for(var u=(typeof d=="string"?d:"").split(/[\s,]+/),l=u.length,p=0;p<l;p++)!u[p]||(d=u[p].replace(/\*/g,".*?"),d[0]==="-"?e.skips.push(new RegExp("^"+d.substr(1)+"$")):e.names.push(new RegExp("^"+d+"$")))}function s(){e.enable("")}function a(d){var u,l;for(u=0,l=e.skips.length;u<l;u++)if(e.skips[u].test(d))return!1;for(u=0,l=e.names.length;u<l;u++)if(e.names[u].test(d))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}}}),xa=Ge({"../../node_modules/.pnpm/debug@2.6.9/node_modules/debug/src/browser.js"(e,r){e=r.exports=ka(),e.log=o,e.formatArgs=n,e.save=i,e.load=s,e.useColors=t,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:a(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function t(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(c){try{return JSON.stringify(c)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}};function n(c){var d=this.useColors;if(c[0]=(d?"%c":"")+this.namespace+(d?" %c":" ")+c[0]+(d?"%c ":" ")+"+"+e.humanize(this.diff),!!d){var u="color: "+this.color;c.splice(1,0,u,"color: inherit");var l=0,p=0;c[0].replace(/%[a-zA-Z%]/g,function(f){f!=="%%"&&(l++,f==="%c"&&(p=l))}),c.splice(p,0,u)}}function o(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(c){try{c==null?e.storage.removeItem("debug"):e.storage.debug=c}catch(d){}}function s(){var c;try{c=e.storage.debug}catch(d){}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}e.enable(s());function a(){try{return window.localStorage}catch(c){}}}}),La=Ge({"../../node_modules/.pnpm/component-cookie@1.1.5/node_modules/component-cookie/index.js"(e,r){var t=xa()("cookie");r.exports=function(d,u,l){switch(arguments.length){case 3:case 2:return n(d,u,l);case 1:return i(d);default:return o()}};function n(d,u,l){l=l||{};var p=a(d)+"="+a(u);u==null&&(l.maxage=-1),l.maxage&&(l.expires=new Date(+new Date+l.maxage)),l.path&&(p+="; path="+l.path),l.domain&&(p+="; domain="+l.domain),l.expires&&(p+="; expires="+l.expires.toUTCString()),l.secure&&(p+="; secure"),document.cookie=p}function o(){var d;try{d=document.cookie}catch(u){return typeof console<"u"&&typeof console.error=="function"&&console.error(u.stack||u),{}}return s(d)}function i(d){return o()[d]}function s(d){var u={},l=d.split(/ *; */),p;if(l[0]=="")return u;for(var f=0;f<l.length;++f)p=l[f].split("="),u[c(p[0])]=c(p[1]);return u}function a(d){try{return encodeURIComponent(d)}catch(u){t("error `encode(%o)` - %o",d,u)}}function c(d){try{return decodeURIComponent(d)}catch(u){t("error `decode(%o)` - %o",d,u)}}}}),ja=Ge({"../../node_modules/.pnpm/@segment+top-domain@3.0.1/node_modules/@segment/top-domain/lib/index.js"(e,r){"use strict";var t=Ra().parse,n=La();function o(i){for(var s=e.cookie,a=e.levels(i),c=0;c<a.length;++c){var d="__tld__",u=a[c],l={domain:"."+u};if(s(d,1,l),s(d))return s(d,null,l),u}return""}o.levels=function(i){var s=t(i).hostname,a=s.split("."),c=a[a.length-1],d=[];if(a.length===4&&c===parseInt(c,10)||a.length<=1)return d;for(var u=a.length-2;u>=0;--u)d.push(a.slice(u).join("."));return d},o.cookie=n,e=r.exports=o}}),eo=Ma(ja()),Le=(...e)=>{window.location.search.search(/[?&]wmpsm_debug=[1t]/)!==-1&&console.info(...e)};function Dt(e,r,t){switch(arguments.length){case 3:case 2:return Na(e,r,t);case 1:return Ua(e);default:return to()}}function Na(e,r,t){t=t||{};let n=zn(e)+"="+zn(r);t.encode===!1&&(n=e+"="+r),r==null&&(t.maxage=-1),t.maxage&&!t.expires&&(t.expires=new Date(+new Date+t.maxage)),t.path&&(n+="; Path="+t.path),t.domain&&(n+="; Domain="+t.domain),t.expires&&(n+="; Expires="+t.expires.toUTCString()),t.samesite&&(n+="; SameSite="+t.samesite),t.secure&&(n+="; Secure"),Le("[COOKIE]: cookie.helper.set()",n,t),document.cookie=n}function to(){let e;try{e=document.cookie}catch(r){return typeof console<"u"&&typeof console.error=="function"&&console.error(r.stack||r),{}}return Va(e)}function Ua(e){let r=to()[e];return Le(`[COOKIE]: helper.get() - getting ${e} cookie value ${r}`),r}function Va(e){let r={},t=e.split(/ *; */),n;if(t[0]=="")return r;for(let o=0;o<t.length;++o){let i=t[o].substr(0,t[o].indexOf("=")),s=t[o].substr(t[o].indexOf("=")+1);r[Yn(i)]=Yn(s)}return r}function zn(e){try{return encodeURIComponent(e)}catch(r){}}function Yn(e){try{return decodeURIComponent(e)}catch(r){}}var Fa=class{constructor(e){this._options={},this.options=this.options.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.remove=this.remove.bind(this),this.options(e)}options(e){if(arguments.length===0)return this._options;e=e||{};let r=e.domain||`.${(0,eo.default)(window.location.href)}`;if(r==="."&&(r=null),this._options=te(P({maxage:31536e6,path:"/",samesite:"Lax",encode:!0},e),{domain:r}),this.set("psm:test",!0,this._options),!this.get("psm:test")){Le("[Cookie]: psm:test cookie could not be set at domain: ",this._options.domain);let t=new RegExp(document.location.hostname,"g");document.referrer!==""&&document.referrer.search(t)===-1?this._options.samesite="None":this._options.domain=null}this.remove("psm:test"),Le("[COOKIE]: this._options",this._options)}set(e,r,t={}){let n=P(P({},this._options),t);Le("[COOKIE]: this.set() options",n);try{return typeof r!="string"&&(r=JSON.stringify(r)),Dt(e,r==="null"?null:r,n),!0}catch(o){return Le("[COOKIE]: this.set() encountered an error",o),!1}}get(e){let r=Dt(e);try{return JSON.parse(r)}catch(t){return r||null}}getAll(){return Dt()}remove(e){try{return Dt(e,null,P({},this._options)),!0}catch(r){return Le("[COOKIE]: this.remove() encountered an error",r),!1}}},S=new Fa,kt=eo.default;function ye(){try{let e=document.cookie;e="cookietest=1; SameSite=Strict;";let r=e.indexOf("cookietest=")!==1;return e="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",r}catch(e){return!1}}function hr(){try{return!!window.localStorage}catch(e){return!0}}function xt(){let e="__psm_test__";if(!hr())return!1;try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(r){return!1}}function ro(){let e=window,r="inner";"innerWidth"in window||(r="client",e=document.documentElement||document.body);let t=e[r+"Width"],n=e[r+"Height"];return t>=0&&n>=0?t+"x"+n:null}function Lt(){let e=document.documentElement,r=document.body,t=r?Math.max(r.offsetHeight,r.scrollHeight):0,n=Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth),o=Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight,t);return isNaN(n)||isNaN(o)?[0,0]:[n,o]}function no(){return window.screen.width+"x"+window.screen.height}function jt(e){let r="";if(e)return e;try{r=window.top.document.referrer}catch(t){if(window.parent)try{r=window.parent.document.referrer}catch(n){r=""}}return r===""&&(r=document.referrer),r}function vr(e,r){let t,n;return function o(...i){let s=Date.now();t=window.clearTimeout(t),!n||s-n>=r?(e(...i),n=s):t=window.setTimeout(o.bind(null,...i),r-(s-n))}}function oo(e){let r=e.getBoundingClientRect();return e.contains(document.elementFromPoint(r.right-r.width/2,r.bottom-r.height/2))}function io(){let e=window.navigator.userAgent,r=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1&&e.indexOf("Chromium")===-1&&e.indexOf("CriOS")===-1&&e.indexOf("EdgiOS")===-1&&e.indexOf("FxiOS")===-1,t=(e.indexOf("Firefox")>-1||e.indexOf("FxiOS")>-1)&&e.indexOf("Seamonkey")===-1,n=(e.indexOf("Chrome")>-1||e.indexOf("CriOS")>-1)&&e.indexOf("Chromium")===-1&&e.indexOf("Edg")===-1&&e.indexOf("OPR")===-1,o=e.indexOf("Edg")>-1;switch(!0){case r:return"safari";case t:return"firefox";case n:return"chrome";case o:return"edge";default:return"unknown"}}function $e(e,r){let t=new RegExp("^[^#]*[?&]"+e+"=([^&#]*)").exec(r);return t?decodeURIComponent(t[1].replace(/\+/g," ")):null}var Po=or(Pr());var Bt=class extends Error{constructor(t){let{request:n,url:o,opts:i}=t,s=n.responseText?n.responseText:"network failure";super(s);this.context={url:o,code:n.status,headers:i.headers,method:i.method}}};function se(e,r={}){return new Promise((t,n)=>{let o=new XMLHttpRequest;o.open(r.method||"get",e),o.onload=()=>{if((o.status/100|0)==2)try{t(JSON.parse(o.responseText))}catch(i){t(o.responseText)}else n(new Bt({request:o,url:e,opts:r}))},o.onerror=()=>{n(new Bt({request:o,url:e,opts:r}))};for(let i in r.headers)o.setRequestHeader(i,r.headers[i]);o.send(r.body||null)})}var Cr,Ye,ze;function Co(e){Ye=e.config.psmEnvironment?e.config.psmEnvironment.toUpperCase():"PROD",ze=e,Cr=new Po.default("logger",Rt,(r,t)=>{if(/bot|crawl|spider/i.test(window.navigator.userAgent))return t(null,{});r.ts=new Date().toISOString(),se(A.logs[Ye],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(n=>t(null,n)).catch(n=>t(n))}),Cr.start()}function Ht(e,r){let t,n,o;e.err?(t=e.err.toString(),n=e.err.stack,o=e.err.context||{}):(t=e.message,o=e.context);let i={brand:ze.config.brand,device:{type:window.navigator.platform,userAgent:window.navigator.userAgent},eventName:r,eventProperties:{logMessage:t,method:e.methodName,featureFlagValues:ze.getFlags(),stackTrace:n},eventType:"log",eventTimestamp:new Date().toISOString(),library:{name:"PrismJS",version:We.version,initConfig:ze.config},platform:"web",session:ze.session,wmukid:ze.wmukid},s=hr()&&window.localStorage.getItem("wmpsm_debug")=="true",a=window.location.search.includes("wmpsm_debug");return r!=="debug"&&(s||a||Ye==="AUTOMATED_TEST"?Ye==="AUTOMATED_TEST"?console[r](`[PSM]: ${r}:`,JSON.stringify(i.eventProperties)):console[r](`[PSM]: ${r}:`,i):i.eventProperties.featureFlagValues["doppler-send-logs"]&&Cr.addItem(i)),i}function Ue(e){return Ht(e,"info")}function R(e){return Ht(e,"debug")}function Oo(e){return Ht(e,"warn")}function Me(e){return Ht(e,"error")}var md=/^[1][nNyY-][nNyY-][nNyY-]$/,Wt=class{constructor(){this.version=1,this.baseString=null}getUSPrivacyString(){return this.baseString}getVersion(){return this.version}setUSPrivacyString(r){let t=!1;if(md.test(r)){this.baseString=r,this.version=Number(r[0]);let n={version:Number(r[0]),uspString:r};S.set("usprivacy",r),S.set("uspData",n),t=!0}return t}};var Ru=new Wt;function Ao(e){let r=null,t;for(t=window;t;t=t.parent){try{if(t.frames&&t.frames[e]){r=t;break}}catch(n){throw new Error(n)}if(t===window.top)break}return r}function Mo(e={}){return new Promise(r=>{typeof window.__tcfapi!="function"&&r({shouldLoad:!1,categories:[]});let t=P({1:"data-store",3:"ads-person-prof",5:"content-person-prof",6:"consent-person",8:"measure-content",9:"measure-market",10:"product-develop"},e);window.__tcfapi("getTCData",2,(n,o)=>{if(o&&"purpose"in n&&"legitimateInterests"in n.purpose){let i=P(P({},n.purpose.legitimateInterests),n.purpose.consents),s=[],a=!0;Object.entries(t).forEach(([c,d])=>{i[c]?s.push({[d]:i[c]}):(s.push({[d]:!1}),a=!1)}),r({shouldLoad:a,categories:s.concat([{"special-purpose-1":!0},{"special-purpose-2":!0},{"feature-1":!0},{"feature-2":!0},{"feature-3":!0}])})}r({shouldLoad:!1,categories:[]})})})}var Kt=null,_e="",V="",Q="";function ko(e){return/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)}function hd(){let e=$e("utm_term",window.location.href),r=new RegExp(/cdpid_([0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12})/i).exec(e),t=null;return r&&(t=r[1]),t}function Ro(e,r){ko(e)?(Q=hd()||e,S.set("CDPID",JSON.stringify({cdpId:Q,wmukId:r}),{samesite:"None",secure:!0,encode:!1})):R({message:`CDPID value ${JSON.stringify(Q)} is invalid. Returning without updating`,methodName:"updateCdpData",eventType:"cdpid"})}function Do(e,r){let t=document.createElement("iframe");t.setAttribute("id",e),t.setAttribute("style","display:none"),t.setAttribute("src",r),document.body.appendChild(t)}function xo(e){return ye()?(_e=S.get("WMUKID"),V=S.get("WMUKID_STABLE"),R({message:`[PSM]: Cookies enabled. Retrieving ID values
    WMUKID: ${JSON.stringify(_e)}
    WMUKID_STABLE: ${V}
    `,methodName:"initIdentity",eventType:"identity"}),V==null&&(_e==null?(V=pe(),R({message:`WMUKID and WMUKID_STABLE cookies not found. Generating WMUKID_STABLE value: ${V}`,methodName:"initIdentity",eventType:"identity"})):typeof _e=="object"&&"id"in _e?(V=_e.id,R({message:`Legacy WMUKID value ${_e.id} found. Setting WMUKID_STABLE value: ${V}`,methodName:"initIdentity",eventType:"identity"})):(V=_e,R({message:`WMUKID string value ${_e} found. Setting WMUKID_STABLE value: ${V}`,methodName:"initIdentity",eventType:"identity"}))),R({message:`Setting WMUKID_STABLE cookie to ${V}. Cookie options: ${JSON.stringify(S.options())}`,methodName:"initIdentity",eventType:"identity"}),e==="ZERO_ID"?(S.set("WMUKID_STABLE",V,S.options({maxage:0})),S.set("datid",V,S.options({maxage:0}))):(S.set("WMUKID_STABLE",V),S.set("datid",V)),V):""}function Lo(e){return new Promise(r=>{if(Do("psm_thirdparty",A.lightningOrigin+A.thirdPartyCookie),window==null||window.addEventListener("message",t=>{t.origin===A.lightningOrigin&&(t.data==="PSM:3PCunsupported"?Kt=!1:t.data==="PSM:3PCsupported"?Kt=!0:(R({message:`Updating CDPID from iFrame value: ${JSON.stringify(t.data)}`,methodName:"initIdentity",eventType:"message"}),Ro(t.data,V),r(t.data)))},!1),ye()){Q=S.get("CDPID");let t=Q&&typeof Q=="object"&&"cdpId"in Q&&ko(Q.cdpId);if(R({message:`[PSM]: Cookies enabled. Retrieving ID values
    CDPID: ${JSON.stringify(Q)}
    `,methodName:"initIdentity",eventType:"identity"}),Q===null||!t)Ao("prism_toolkit")===null&&Do("prism_toolkit",A.lightningOrigin+A.iFramePath[e]);else if(typeof Q=="object"&&"cdpId"in Q&&"wmukId"in Q&&t){let n=Q.cdpId,o=Q.wmukId;V!==o?(R({message:`Updating CDPID value ${n} with WMUKID: ${V}`,methodName:"initIdentity",eventType:"cdpid"}),Ro(n,V)):R({message:`CDPID cookie has already been set to value ${JSON.stringify(Q)}. To start a new test, delete the CDPID cookie on this domain and lightning.warnermediacdn.com.`,methodName:"initIdentity",eventType:"cdpid"}),r(n)}}})}window.googletag=window.googletag||{cmd:[]};var ft,Ar=()=>Math.round(Date.now()/1e3),ie=[],jo=(...e)=>{window==null||window.location.search.search(/[?&]wmpsm_debug=[1t]/)};function No(e,r){let t=Ar(),n=0;r.lastHoverStarted!==0&&(n=t-r.lastHoverStarted),e==="mouseleave"?r.totalHoverTime+=n:r.lastHoverStarted=t}function Uo(e,r){e.addEventListener("mouseenter",()=>{No("mouseenter",r)}),e.addEventListener("mouseleave",()=>{No("mouseleave",r)})}var vd=(e,r)=>{window.googletag=(window==null?void 0:window.googletag)||{cmd:[]},window==null||window.googletag.cmd.push(()=>{window.googletag.pubads().addEventListener("slotRenderEnded",t=>{let n=t.slot.getSlotElementId(),o=t.slot.getAdUnitPath(),i=document==null?void 0:document.getElementById(n),s="0x0";t.size&&(typeof t.size=="string"?s=t.size:s=t.size.join("x"));let a={slotId:n,slotSize:s,adUnitPath:o,totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1,rfv:t.slot.getTargeting("rfv")[0],creativeId:t.slot.getTargeting("creativeId")[0],lineItemId:t.slot.getTargeting("lineItemId")[0],totalHoverTime:0,lastHoverStarted:0};Or(a),i&&(e.observe(i),Uo(i,a))}),window.googletag.pubads().addEventListener("slotVisibilityChanged",t=>{let n=t.slot.getSlotElementId();r.forEach(o=>{o.slotId===n&&(o.rfv=t.slot.getTargeting("rfv")[0],o.creativeId=t.slot.getTargeting("creativeId")[0],o.lineItemId=t.slot.getTargeting("lineItemId")[0])})}),window.googletag.pubads().getSlots().forEach(t=>{let n=t.getSlotElementId(),o=document==null?void 0:document.getElementById(n),i={width:0,height:0};o&&(i=o.getBoundingClientRect());let s={slotId:n,slotSize:i?`${Math.round(i.width)}x${Math.round(i.height)}`:"0x0",adUnitPath:t.getAdUnitPath(),totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1,rfv:t.getTargeting("rfv")[0],creativeId:t.getTargeting("creativeId")[0],lineItemId:t.getTargeting("lineItemId")[0],totalHoverTime:0,lastHoverStarted:0};Or(s),o&&(e.observe(o),Uo(o,s))})})};function Vo(){ft=new IntersectionObserver(e=>{e.forEach(r=>{let t=r.target.id,n=Math.round(r.intersectionRatio)*100,o=r.boundingClientRect;r.isIntersecting?r.intersectionRatio>=.5&&oo(r.target)&&(jo(`slotVisibilityChanged - ${t} is in view. (${n}% in view)`),ie.forEach(i=>{i.slotId===t&&(i.visibleOnStart=!0,i.adWasViewed=!0,i.slotSize=`${o.width}x${o.height}`,Ho(i))})):(jo(`slotVisibilityChanged - ${t} is no longer in view. (${n}% in view)`),ie.forEach(i=>{i.slotId===t&&(i.visibleOnStart=!1,i.lastViewStarted=0,i.lastHoverStarted=0)}))})},{root:null,rootMargin:"0px",threshold:[0,.5,1]}),vd(ft,ie)}document==null||document.addEventListener("inbrain.loaded",e=>{e.detail.forEach(r=>{let t=document==null?void 0:document.getElementById(r);if(t){let n=t.getBoundingClientRect();Or({slotId:r,slotSize:n?`${Math.round(n.width)}x${Math.round(n.height)}`:"0x0",totalViewTime:0,lastViewStarted:0,visibleOnStart:!1,adWasViewed:!1,totalHoverTime:0,lastHoverStarted:0}),ft.observe(t)}})});var Or=e=>{ie.some(r=>e.slotId===r.slotId)||ie.push(e)};function Fo(){ie.forEach(e=>{e.visibleOnStart&&(e.lastViewStarted=0);let r=document==null?void 0:document.getElementById(e.slotId);r&&ft.unobserve(r)})}function qo(){ie.forEach(e=>{e.visibleOnStart&&(e.lastViewStarted=Ar());let r=document==null?void 0:document.getElementById(e.slotId);r&&ft.observe(r)})}function Bo(){ie.forEach(e=>{e.visibleOnStart&&Ho(e)})}function Gt(){ie.forEach(e=>{e.totalViewTime=0,e.totalHoverTime=0,e.adWasViewed=!1})}function Ho(e){let r=e.lastViewStarted,t=Ar();if(r){let n=t-r;e.totalViewTime+=n}e.lastViewStarted=t}var Ko=new Date().toISOString(),$t,fe={totalTime:0,engagedTime:0,interval:3e4/1e3,maxScrollDepth:window.scrollY<0?0:window.scrollY,currentScrollPosition:window.scrollY<0?0:window.scrollY,didScrollUpDuringInterval:!1},yd=e=>{$t=e},Sd=["mousedown","mousemove","keydown"],_d=["scroll","focus"];function Wo(){let e=window.scrollY,r=e<0?0:e,t=Lt()[1];r>fe.currentScrollPosition&&(fe.maxScrollDepth=r>=t?t:r),r<fe.currentScrollPosition&&(fe.didScrollUpDuringInterval=!0),fe.currentScrollPosition=r;let n=new Date;if($t){let o=Math.round((n.getTime()-$t)/1e3);o<=3&&(fe.engagedTime+=o)}yd(n.getTime())}var Go=()=>{Sd.forEach(e=>{window.addEventListener(e,vr(Wo,1e3))}),_d.forEach(e=>{window.addEventListener(e,vr(Wo,1e3))})},mt=()=>{let e=new Date,r=new Date(Ko);fe.totalTime=Math.round((e.getTime()-r.getTime())/1e3)},Jt=()=>{fe={totalTime:0,engagedTime:0,interval:3e4/1e3,maxScrollDepth:window.scrollY<0?0:window.scrollY,currentScrollPosition:window.scrollY<0?0:window.scrollY,didScrollUpDuringInterval:!1},Ko=new Date().toISOString(),$t=Date.now()};var Ze="inbrain-surveys",de=window,j=document,$o=[],Jo=[],Qo=[],zo=[];var bd={watchSlidesProgress:!0,slidesPerView:"auto",spaceBetween:20,navigation:{nextEl:".inbrain-control-next",prevEl:".inbrain-control-prev"}},H,Xo,Mr=!1,wd=(...e)=>{window.location.search.search(/[?&]wmpsm_debug=[1t]/)};function Re(e){let{env:r,data:t}=e;try{se(A.identity[r],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(n){R({err:n,eventType:"inbrain",methodName:"sendEvent"})}}function Td({domain:e,pages:r}){if(window.location.hostname!=e)return!1;let t=[];try{r.forEach(n=>{let o=n.split("/"),i=window.location.pathname.split("/"),s=!0;i.forEach((a,c)=>{o[c]!="*"&&o[c]!=a&&(s=!1)}),t.push(s)})}catch(n){return Me({err:n,eventType:"inbrain",methodName:"shouldRender"}),!1}return t.indexOf(!0)!=-1}function Rr(e){return new Promise(r=>{let t=j.querySelector(e);t&&r(t),new MutationObserver((n,o)=>{t=j.querySelector(e),t&&(r(t),o.disconnect())}).observe(j.documentElement,{childList:!0,subtree:!0})})}function Id(e){return e=e||bd,e.watchSlidesProgress=!0,e.slidesPerView="auto",new Promise(r=>{let t=j.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=A.lightningOrigin+A.carouselStyles,j.head.appendChild(t);let n=j.createElement("script");n.type="text/javascript",n.src=A.lightningOrigin+A.carouselScript,n.addEventListener("load",()=>{de.inbrainCarousel=new Swiper(".inbrain-carousel",e),r(!0)}),j.head.appendChild(n)})}function Ed(e){let r=S.get("wmhhid"),t=S.get("usprivacy"),n=e.getLocationProperties(),o=e.getDeviceProperties(),i=e.getIds(),s=e.getBrand(),a=e.getFlags(),c=JSON.parse(localStorage.getItem(Ze))||{};return{wmukid:e.wmukid,cdpid:e.getCDPID(),url:window.location.href,usp:t,betaTemplate:e.queryFlag("inBrainTemplateBeta")?"true":"false",betaRecommendations:e.queryFlag("inBrainRecommendationsBeta")?"true":"false",deviceType:o.type,location:n.state,language:n.language,ecid:i.ecid,kruxid:i.kruxid,brand:s,wmhhid:r,surveyStorage:c,flags:a}}function De(e){let{psm:r,id:t,promoPosition:n,destinationURL:o,surveyQuestion:i,surveyResponse:s,surveyChoices:a,surveyID:c}=e;Xo={id:t,promoPosition:n,destinationURL:o,surveyQuestion:i,surveyResponse:s,surveyChoices:a,surveyID:c,featureFlagValues:r.getFlags()}}function ei(){return Xo}async function ti(e,r){let t=e.config.psmEnvironment.toUpperCase();if(H=r,!de.optimizelyInControlOfInBrain&&!e.queryFlag("inbrain")||de.optimizelyInControlOfInBrain&&!de.optimizelyInBrainEnabled||e.wmukid=="Unknown")return;Mr=de.location.search.search(/[?&]surveyOverride=[1t]/)!==-1?!0:!!e.queryFlag("inBrainSurvey"),wd("INBRAIN v2.0.5");let o=null;try{let m=de.location.search.search(/[?&]localhost=[1t]/)!==-1,h=m?A.inbrain.LOCAL:A.inbrain[t];m&&(console.log("INBRAIN inbrainURL used: ",h),console.log("INBRAIN localhost: ",m),console.log("INBRAIN win.location.search.search(/[?&]localhost=[1t]/): ",de.location.search.search(/[?&]localhost=[1t]/))),o=await se(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ed(e))})}catch(m){Me({err:m,eventType:"inbrain",methodName:"initInbrain"});return}if(!o)return;let{domain:i,pages:s,target:a,placement:c,html:d,carousel:u,newsfeed:l,survey:p}=o;if(!Td({domain:i,pages:s}))return;Rr(a).then(()=>{let m;try{m=decodeURIComponent(d)}catch(h){Me({err:h,eventType:"inbrain",methodName:"initInbrainV2"});return}switch(c){case"within":j.querySelector(a).innerHTML=m;break;case"before":j.querySelector(a).insertAdjacentHTML("beforebegin",m);break;case"after":j.querySelector(a).insertAdjacentHTML("afterend",m);break}Id(u).then(()=>{Dr({psm:e,env:t}),de.inbrainCarousel.on("slideChange",function(){Dr({psm:e,env:t}),Yo({psm:e,env:t})}),window.document.addEventListener("resize",()=>{Dr({psm:e,env:t})}),new IntersectionObserver((h,y)=>{h.forEach(w=>{(w.isIntersecting||w.intersectionRatio>=.5)&&(Yo({psm:e,env:t}),y.disconnect())})},{root:null,rootMargin:"0px",threshold:[0,.5,1]}).observe(j.querySelector(a))}),Pd().forEach(h=>{let y=h.dataset.inbrain,w=h.dataset.slotindex,b=h.href;h.addEventListener("click",()=>{De({psm:e,id:y,promoPosition:w,destinationURL:b}),L(e,H),H.trackInbrain("Inbrain Click",new Date().toISOString(),T=>{Re({env:t,data:T}),t==="AUTOMATED_TEST"&&de.localStorage.setItem("Inbrain-Click",JSON.stringify(T))})})})});let f=p&&p.surveys&&p.surveys[0],g=JSON.parse(localStorage.getItem(Ze))||{};if((!g||!g.hasOwnProperty(f))&&(g[f]={timesViewed:"0",answered:"false",choice:"",doNotShowAgain:"false"}),localStorage.getItem("inbrain-do-not-show-surveys")=="true"&&(Mr=!1),Mr&&p&&p.html!==""&&g[f].answered=="false"){let m=p.question,h=p.target;Rr(h).then(()=>{let y;try{y=decodeURIComponent(p.html)}catch(O){Me({err:O,eventType:"inbrain",methodName:"initInbrainV2"});return}switch(p.placement){case"within":j.querySelector(h).innerHTML=y;break;case"before":j.querySelector(h).insertAdjacentHTML("beforebegin",y);break;case"after":j.querySelector(h).insertAdjacentHTML("afterend",y);break}g[f].timesViewed=(parseInt(g[f].timesViewed)+1).toString(),localStorage.setItem(Ze,JSON.stringify(g)),Ad({psm:e,env:t,surveyID:f,surveyQuestion:m});let w=xr(),b=document.querySelector(".inbrain-survey-container span");function T(){w.style.display="none"}b.addEventListener("click",T);let E=document.getElementById("survey-submit-btn");E||document.querySelectorAll(".survey-choice-wrapper").forEach(O=>{O.addEventListener("click",()=>{let k=[],x=O.firstElementChild;k.push(x.value),Zo({psm:e,env:t},m,k,f),T(),g[f].answered="true",g[f].choice=k.toString(),localStorage.setItem(Ze,JSON.stringify(g))})});function C(){let O=[],k=document.querySelector(".survey-question").innerHTML,Y=document.querySelector(".inbrain-survey-body input").getAttribute("name"),ve=document.getElementsByName(Y),wt=Array.from(ve);for(let qe=0;qe<wt.length;qe++){let ue=wt[qe];ue.type=="checkbox"||ue.type=="radio"?ue.checked&&O.push(ue.value):O.push(ue.value)}Zo({psm:e,env:t},k,O,f),T(),g[f].answered="true",g[f].choice=O.toString(),localStorage.setItem(Ze,JSON.stringify(g))}document.getElementById("do-not-show-survey-again").addEventListener("click",()=>{g[f].doNotShowAgain="true",localStorage.setItem(Ze,JSON.stringify(g)),T()}),E.addEventListener("click",C),document.getElementById("survey-do-not-show-btn").addEventListener("click",()=>{localStorage.setItem("inbrain-do-not-show-surveys","true"),T()})})}if(l&&l.html!==""){let m=l.target;Rr(m).then(()=>{let h;try{h=decodeURIComponent(l.html)}catch(y){Me({err:y,eventType:"inbrain",methodName:"initInbrainV2"});return}switch(l.placement){case"within":j.querySelector(m).innerHTML=h;break;case"before":j.querySelector(m).insertAdjacentHTML("beforebegin",h);break;case"after":j.querySelector(m).insertAdjacentHTML("afterend",h);break}Cd({psm:e,env:t}),new IntersectionObserver((y,w)=>{y.forEach(b=>{(b.isIntersecting||b.intersectionRatio>=.5)&&(Md({psm:e,env:t}),w.disconnect())})},{root:null,rootMargin:"0px",threshold:[0,.5,1]}).observe(j.querySelector(m)),kr().forEach(y=>{let w=y.dataset.newsfeed,b=y.dataset.slotindex,T=y.href;y.addEventListener("click",()=>{De({psm:e,id:w,position:b,destinationURL:T}),L(e,H),H.trackInbrain("Inbrain Newsfeed Click",new Date().toISOString(),E=>{Re({env:t,data:E})})})})})}}function ri(e=!1){let r=document.querySelectorAll(".swiper-slide-visible > div > a");if(e){let t=[];return r.forEach(n=>{t.push(n.dataset.inbrain)}),t}return r}function Pd(){return document.querySelectorAll("[data-inbrain]")}function kr(){return j.querySelectorAll("[data-newsfeed]")}function Dr({psm:e,env:r}){ri().forEach(t=>{let n=t.dataset.inbrain;$o.includes(n)||(De({psm:e,id:n}),L(e,H),H.trackInbrain("Inbrain Promo Loaded",new Date().toISOString(),o=>{Re({env:r,data:o}),r==="AUTOMATED_TEST"&&de.localStorage.setItem("Inbrain-Promo-Loaded",JSON.stringify(o))}),$o.push(n))})}function Cd({psm:e,env:r}){kr().forEach(t=>{let n=t.dataset.newsfeed;Qo.includes(n)||(De({psm:e,id:n}),L(e,H),H.trackInbrain("Inbrain Newsfeed Loaded",new Date().toISOString(),o=>{Re({env:r,data:o})}),Qo.push(n))})}function Yo({psm:e,env:r}){ri().forEach(t=>{let n=t.dataset.inbrain;Jo.includes(n)||(De({psm:e,id:n}),L(e,H),H.trackInbrain("Inbrain Promo Visible",new Date().toISOString(),o=>{Re({env:r,data:o}),r==="AUTOMATED_TEST"&&de.localStorage.setItem("Inbrain-Promo-Visible",JSON.stringify(o))}),Jo.push(n))})}function xr(){return j.getElementById("inbrain-survey")}function Od(){let e=document.querySelectorAll(".survey-answer"),r=[];return e.forEach(t=>{r.push(t.innerHTML)}),r}function Ad({psm:e,env:r,surveyID:t,surveyQuestion:n}){let i=xr().dataset.survey;De({psm:e,id:i,surveyID:t,surveyQuestion:n}),L(e,H),H.trackInbrain("Inbrain Survey Visible",new Date().toISOString(),s=>{Re({env:r,data:s})})}function Zo({psm:e,env:r},t,n,o){let i=xr(),s=Od(),a=i.dataset.survey;De({psm:e,id:a,surveyQuestion:t,surveyResponse:n,surveyChoices:s,surveyID:o}),L(e,H),H.trackInbrain("Inbrain Survey Response",new Date().toISOString(),c=>{Re({env:r,data:c})})}function Md({psm:e,env:r}){kr().forEach(t=>{let n=t.dataset.newsfeed;zo.includes(n)||(De({psm:e,id:n}),L(e,H),H.trackInbrain("Inbrain Newsfeed Visible",new Date().toISOString(),o=>{Re({env:r,data:o})}),zo.push(n))})}function Lr(){return typeof window.turner_getTransactionId=="function"?window.turner_getTransactionId():null}function jr(){return ye()?S.get("ug"):null}function Xe(){return xt()?window.localStorage.getItem("kxkuid"):ye()?S.get("kxkuid"):null}function et(){if(ye()){let e=S.get("firstpartyuid");return e&&typeof e=="object"&&"id"in e?e.id:null}return null}function Nr(){let e=null;return ye()&&(e=S.get("OptanonConsent")),e}function Rd(e){let r=S.get("AMCV_7FF852E2556756057F000101@AdobeOrg");if(r){let t=r.split("|"),n=t.indexOf(e);if(n!=-1){let o=n+1;return t[o]}}return null}function tt(){let e=S.get("s_ecid"),r=S.get("s_vi");return e||r||Rd("MCMID")}function Ve(){let e=null,r=null;if(xt()&&(r=window.localStorage.getItem("zion.cnn_uid"),r))try{r=JSON.parse(r),e=r.id}catch(t){window.location.search.includes("wmpsm_debug")}return e}function rt(){if(xt()){let e=["Conviva/sdkConfig","Conviva.sdkConfig","top-player::Conviva.sdkConfig"],r=null;for(let t=0;t<e.length;t++)if(r=window.localStorage.getItem(e[t]),r)try{return JSON.parse(r).clId}catch(n){window.location.search.includes("wmpsm_debug")}}return null}function nt(){let e=null;if(window.ZionMessageBus){let t=window.ZionMessageBus.getInstance().watching.id_found.messageQueue;if(t&&t instanceof Array){let n=t.find(o=>{var s;let i=(s=o.message)==null?void 0:s.type;if(typeof i=="string")return i.toLowerCase()==="zaid"});e=n?n.message.value:null}}return e}function ni(e,r){let t=null;if(e)for(let n of e){if(typeof n!="string")continue;r&&(n=n.replace(/^data/,r));let o=n.match(/[^.[\]()]+/g);for(let i=0;i<o.length;i++)if(i===0&&(t=window),t=t[o[i]],typeof t=="function"&&(t=t()),typeof t>"u"){t=null;break}if(t)return t}return t}function oi(e,r){let t={};return e&&e[r]&&e[r].forEach(n=>{let o=ni(n.staticLocations);o||(o=ni(n.dynamicLocations,"psmPubSubData."+r)),t[n.name]=o}),t}var L=(e,r)=>{let t=Lt(),n=e.coppaPrivacyMode==="ALL_ID"?{attuuid:et(),cdpid:e.getCDPID(),cnnuid:Ve(),convivaid:rt(),ecid:tt(),kruxid:Xe(),liverampatsid:S.get("tok_lr"),tradedeskuid:S.get("tok_ttuid"),wmhhid:S.get("wmhhid"),wminid:S.get("wminid"),zionid:nt(),hhidVersion:S.get("hhidVersion")}:{};r.setPlatform(e.config.platform),r.addEntry("companyName","WarnerMedia"),r.setBrand(e.config.brand),r.setSubBrand(e.config.subBrand),r.setProductName(e.config.productName),r.setLibrary({name:"PrismJS",version:We.version,initConfig:e.config}),r.setDevice({type:window.navigator.platform,userAgent:window.navigator.userAgent,totalWidth:t[0],totalHeight:t[1],screenResolution:no(),viewportSize:ro()}),r.setNavigationProperties({url:window.location.href,rootDomain:kt(window.location.href),referrer:jt(),path:window.location.pathname,search:window.location.search,title:window.document.title}),r.setClientResolvedIp(e.location.ip_address),r.setLocation({city:e.location.states[0].cities[0],state:e.location.states[0].state,country:e.location.country,zip:e.location.states[0].zipcodes[0],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone||null,locale:window.navigator.language,language:window.navigator.language.split("-")[0]||null}),r.setConsentProperties({uspString:S.get("usprivacy"),consentRule:e.consentRule,optanonConsent:Nr(),psmPrivacyMode:e.coppaPrivacyMode}),r.setIABCategories({consentCategories:e.consentCategories}),r.setWMUKID(e.wmukid),r.setEventProperties({cookiesEnabled:ye(),thirdPartyCookiesEnabled:Kt,doNotTrack:!!(window.navigator.doNotTrack||window.doNotTrack),featureFlagValues:e.getFlags(),cookies:S.getAll(),optimizelyFlagValues:{optimizelyInBrainEnabled:window.optimizelyInBrainEnabled||!1,optimizelyInControlOfInBrain:window.optimizelyInControlOfInBrain||!1},automatedTest:e.config.psmEnvironment==="AUTOMATED_TEST",heartbeat:fe,inbrain:ei()}),r.setSessionProperties(e.session),r.setAdsProperties({guid:jr(),transid:Lr(),ads:ie}),r.setThirdPartyIds(n),r.setContentMetadata({page:oi(e.config.contentMetadata,"page"),video:oi(e.config.contentMetadata,"video")})};var ii=e=>{let r=window;return r.WM=r.WM||{},r.WM.PSM=r.WM.PSM||{},{psmObject:r.WM.PSM,initWMUKID:xo,initCDPID:Lo,getWMUKID:()=>S.get("WMUKID_STABLE")||"Unknown",getCDPID:()=>{let n=S.get("CDPID");return n&&typeof n=="object"&&"cdpId"in n&&"wmukId"in n?n.cdpId:n||"Unknown"},getConsentProperties:()=>({uspString:S.get("usprivacy"),consentRule:e.consentRule,optanonConsent:Nr()||"",psmPrivacyMode:e.coppaPrivacyMode}),resolveAuthTokens:async(n,o,i)=>{if(!i.queryFlag("auth-service"))return R({message:"[PSM]: auth-service flag is disabled",methodName:"resolveAuthTokens",eventType:"authService"}),!1;let s=!0,a=!1,c=o.get("resolveAuthTimestamp");if(c){let I=new Date(c),O=(Date.now()-I.getTime())/1e3/60/60;if(O<24)return Ue({message:`Resolve Auth Token lifespan, ${O}, less than 24 hours`,methodName:"resolveAuthTokens",eventType:"authService"}),!1}let d,u,l,p,f,g=o.get("tok_lr"),m=o.get("tok_ttuid"),h=o.get("tok_lr2"),y=g||h;y&&(d={provider:"Liveramp ATS",details:{id:y}},s=!1,a=!0);let w=$e("bt_ts",window.location.href),b=$e("utm_term",window.location.href);if(w&&b){let I=(Date.now()-parseInt(w))/1e3/60/60;if(I>24)return Ue({message:`bt_ts Parameter lifespan, ${I}, greater than 24 hours`,methodName:"resolveAuthTokens",eventType:"authService"}),!1;u={provider:"zeta",details:{id:b}}}let T=$e("primo",window.location.href);T&&(l={provider:"braze",details:{id:T}});let E=Ve();if(E&&(p={provider:"cnnAuthentication",details:{id:E}}),m&&(f={provider:"tradedesk",details:{id:m}}),!y&&(!b||!w)&&!T&&!E)return R({message:"[PSM]: No token information present",methodName:"resolveAuthTokens",eventType:"authService"}),!1;let C=[];d!=null&&d.provider&&C.push(d),u!=null&&u.provider&&C.push(u),l!=null&&l.provider&&C.push(l),p!=null&&p.provider&&C.push(p),f!=null&&f.provider&&C.push(f);let D={wmukid:i.getWMUKID(),brand:i.config.brand,ids:{attuuid:et(),cdpid:i.getCDPID(),convivaid:rt(),ecid:tt(),kruxid:Xe(),wmhhid:o.get("wmhhid"),wminid:o.get("wminid"),zionid:nt(),cnnuid:Ve()},location:i.getLocationProperties(),consentProperties:{usp:o.get("usprivacy")},authentication:C};try{let I=await se(A.authSvc[i.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)}),{tokens:O}=I,k=O.filter(Y=>Y.provider==="liveramp")[0];k&&(o.set("tok_lr",k.token,{expires:new Date(k.expiration)}),o.set("tok_lr2",k.token,{expires:new Date(k.expiration)}));let x=O.filter(Y=>Y.provider==="tradedesk")[0];x&&(o.set("tok_ttuid",x.token,{expires:new Date(x.expiration)}),o.set("tok_ttuid_refresh",x.refreshToken,{expires:new Date(x.expiration)}))}catch(I){R({err:I,eventType:"authService",methodName:"resolveAuthTokens"})}return i.setSessionProperties(),L(i,n),s&&n.trackTokenEvent("new token",new Date().toISOString(),I=>{i.queryFlag("doppler-send-token-event")&&(i.requestQueue.addItem(I),i.resetNewSessionFields())}),a&&n.trackTokenEvent("token updated",new Date().toISOString(),I=>{i.queryFlag("doppler-send-token-event")&&(i.requestQueue.addItem(I),i.resetNewSessionFields())}),o.set("resolveAuthTimestamp",new Date),!0},platform:window.navigator.platform}};He();var Dd=Object.create,ui=Object.defineProperty,kd=Object.getOwnPropertyDescriptor,pi=Object.getOwnPropertyNames,xd=Object.getPrototypeOf,Ld=Object.prototype.hasOwnProperty,v=(e,r)=>function(){return r||(0,e[pi(e)[0]])((r={exports:{}}).exports,r),r.exports},jd=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of pi(r))!Ld.call(e,o)&&o!==t&&ui(e,o,{get:()=>r[o],enumerable:!(n=kd(r,o))||n.enumerable});return e},Nd=(e,r,t)=>(t=e!=null?Dd(xd(e)):{},jd(r||!e||!e.__esModule?ui(t,"default",{value:e,enumerable:!0}):t,e)),ge=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/fails.js"(e,r){r.exports=function(t){try{return!!t()}catch(n){return!0}}}}),fi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/function-bind-native.js"(e,r){var t=ge();r.exports=!t(function(){var n=function(){}.bind();return typeof n!="function"||n.hasOwnProperty("prototype")})}}),me=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/function-uncurry-this.js"(e,r){var t=fi(),n=Function.prototype,o=n.bind,i=n.call,s=t&&o.bind(i,i);r.exports=t?function(a){return a&&s(a)}:function(a){return a&&function(){return i.apply(a,arguments)}}}}),Ud=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/classof-raw.js"(e,r){var t=me(),n=t({}.toString),o=t("".slice);r.exports=function(i){return o(n(i),8,-1)}}}),Vd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/indexed-object.js"(e,r){var t=me(),n=ge(),o=Ud(),i=Object,s=t("".split);r.exports=n(function(){return!i("z").propertyIsEnumerable(0)})?function(a){return o(a)=="String"?s(a,""):i(a)}:i}}),gi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/require-object-coercible.js"(e,r){var t=TypeError;r.exports=function(n){if(n==null)throw t("Can't call method on "+n);return n}}}),vt=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-indexed-object.js"(e,r){var t=Vd(),n=gi();r.exports=function(o){return t(n(o))}}}),be=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/global.js"(e,r){var t=function(n){return n&&n.Math==Math&&n};r.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||function(){return this}()||Function("return this")()}}),Xt=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/is-pure.js"(e,r){r.exports=!1}}),qr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/define-global-property.js"(e,r){var t=be(),n=Object.defineProperty;r.exports=function(o,i){try{n(t,o,{value:i,configurable:!0,writable:!0})}catch(s){t[o]=i}return i}}}),Br=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/shared-store.js"(e,r){var t=be(),n=qr(),o="__core-js_shared__",i=t[o]||n(o,{});r.exports=i}}),mi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/shared.js"(e,r){var t=Xt(),n=Br();(r.exports=function(o,i){return n[o]||(n[o]=i!==void 0?i:{})})("versions",[]).push({version:"3.23.4",mode:t?"pure":"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"})}}),hi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-object.js"(e,r){var t=gi(),n=Object;r.exports=function(o){return n(t(o))}}}),we=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/has-own-property.js"(e,r){var t=me(),n=hi(),o=t({}.hasOwnProperty);r.exports=Object.hasOwn||function(s,a){return o(n(s),a)}}}),vi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/uid.js"(e,r){var t=me(),n=0,o=Math.random(),i=t(1 .toString);r.exports=function(s){return"Symbol("+(s===void 0?"":s)+")_"+i(++n+o,36)}}}),ee=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/is-callable.js"(e,r){r.exports=function(t){return typeof t=="function"}}}),er=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/get-built-in.js"(e,r){var t=be(),n=ee(),o=function(i){return n(i)?i:void 0};r.exports=function(i,s){return arguments.length<2?o(t[i]):t[i]&&t[i][s]}}}),Fd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/engine-user-agent.js"(e,r){var t=er();r.exports=t("navigator","userAgent")||""}}),qd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/engine-v8-version.js"(e,r){var t=be(),n=Fd(),o=t.process,i=t.Deno,s=o&&o.versions||i&&i.version,a=s&&s.v8,c,d;a&&(c=a.split("."),d=c[0]>0&&c[0]<4?1:+(c[0]+c[1])),!d&&n&&(c=n.match(/Edge\/(\d+)/),(!c||c[1]>=74)&&(c=n.match(/Chrome\/(\d+)/),c&&(d=+c[1]))),r.exports=d}}),yi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/native-symbol.js"(e,r){var t=qd(),n=ge();r.exports=!!Object.getOwnPropertySymbols&&!n(function(){var o=Symbol();return!String(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&t&&t<41})}}),Si=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/use-symbol-as-uid.js"(e,r){var t=yi();r.exports=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}),yt=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/well-known-symbol.js"(e,r){var t=be(),n=mi(),o=we(),i=vi(),s=yi(),a=Si(),c=n("wks"),d=t.Symbol,u=d&&d.for,l=a?d:d&&d.withoutSetter||i;r.exports=function(p){if(!o(c,p)||!(s||typeof c[p]=="string")){var f="Symbol."+p;s&&o(d,p)?c[p]=d[p]:a&&u?c[p]=u(f):c[p]=l(f)}return c[p]}}}),St=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/is-object.js"(e,r){var t=ee();r.exports=function(n){return typeof n=="object"?n!==null:t(n)}}}),_t=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/an-object.js"(e,r){var t=St(),n=String,o=TypeError;r.exports=function(i){if(t(i))return i;throw o(n(i)+" is not an object")}}}),Te=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/descriptors.js"(e,r){var t=ge();r.exports=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})}}),_i=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/v8-prototype-define-bug.js"(e,r){var t=Te(),n=ge();r.exports=t&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})}}),bi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/document-create-element.js"(e,r){var t=be(),n=St(),o=t.document,i=n(o)&&n(o.createElement);r.exports=function(s){return i?o.createElement(s):{}}}}),wi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/ie8-dom-define.js"(e,r){var t=Te(),n=ge(),o=bi();r.exports=!t&&!n(function(){return Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a!=7})}}),tr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/function-call.js"(e,r){var t=fi(),n=Function.prototype.call;r.exports=t?n.bind(n):function(){return n.apply(n,arguments)}}}),Bd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-is-prototype-of.js"(e,r){var t=me();r.exports=t({}.isPrototypeOf)}}),Ti=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/is-symbol.js"(e,r){var t=er(),n=ee(),o=Bd(),i=Si(),s=Object;r.exports=i?function(a){return typeof a=="symbol"}:function(a){var c=t("Symbol");return n(c)&&o(c.prototype,s(a))}}}),Hd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/try-to-string.js"(e,r){var t=String;r.exports=function(n){try{return t(n)}catch(o){return"Object"}}}}),Wd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/a-callable.js"(e,r){var t=ee(),n=Hd(),o=TypeError;r.exports=function(i){if(t(i))return i;throw o(n(i)+" is not a function")}}}),Kd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/get-method.js"(e,r){var t=Wd();r.exports=function(n,o){var i=n[o];return i==null?void 0:t(i)}}}),Gd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/ordinary-to-primitive.js"(e,r){var t=tr(),n=ee(),o=St(),i=TypeError;r.exports=function(s,a){var c,d;if(a==="string"&&n(c=s.toString)&&!o(d=t(c,s))||n(c=s.valueOf)&&!o(d=t(c,s))||a!=="string"&&n(c=s.toString)&&!o(d=t(c,s)))return d;throw i("Can't convert object to primitive value")}}}),$d=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-primitive.js"(e,r){var t=tr(),n=St(),o=Ti(),i=Kd(),s=Gd(),a=yt(),c=TypeError,d=a("toPrimitive");r.exports=function(u,l){if(!n(u)||o(u))return u;var p=i(u,d),f;if(p){if(l===void 0&&(l="default"),f=t(p,u,l),!n(f)||o(f))return f;throw c("Can't convert object to primitive value")}return l===void 0&&(l="number"),s(u,l)}}}),Ii=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-property-key.js"(e,r){var t=$d(),n=Ti();r.exports=function(o){var i=t(o,"string");return n(i)?i:i+""}}}),Fe=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-define-property.js"(e){var r=Te(),t=wi(),n=_i(),o=_t(),i=Ii(),s=TypeError,a=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",u="configurable",l="writable";e.f=r?n?function(f,g,m){if(o(f),g=i(g),o(m),typeof f=="function"&&g==="prototype"&&"value"in m&&l in m&&!m[l]){var h=c(f,g);h&&h[l]&&(f[g]=m.value,m={configurable:u in m?m[u]:h[u],enumerable:d in m?m[d]:h[d],writable:!1})}return a(f,g,m)}:a:function(f,g,m){if(o(f),g=i(g),o(m),t)try{return a(f,g,m)}catch(h){}if("get"in m||"set"in m)throw s("Accessors not supported");return"value"in m&&(f[g]=m.value),f}}}),Jd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/math-trunc.js"(e,r){var t=Math.ceil,n=Math.floor;r.exports=Math.trunc||function(i){var s=+i;return(s>0?n:t)(s)}}}),Ei=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-integer-or-infinity.js"(e,r){var t=Jd();r.exports=function(n){var o=+n;return o!==o||o===0?0:t(o)}}}),Qd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-absolute-index.js"(e,r){var t=Ei(),n=Math.max,o=Math.min;r.exports=function(i,s){var a=t(i);return a<0?n(a+s,0):o(a,s)}}}),zd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/to-length.js"(e,r){var t=Ei(),n=Math.min;r.exports=function(o){return o>0?n(t(o),9007199254740991):0}}}),Yd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/length-of-array-like.js"(e,r){var t=zd();r.exports=function(n){return t(n.length)}}}),Zd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/array-includes.js"(e,r){var t=vt(),n=Qd(),o=Yd(),i=function(s){return function(a,c,d){var u=t(a),l=o(u),p=n(d,l),f;if(s&&c!=c){for(;l>p;)if(f=u[p++],f!=f)return!0}else for(;l>p;p++)if((s||p in u)&&u[p]===c)return s||p||0;return!s&&-1}};r.exports={includes:i(!0),indexOf:i(!1)}}}),Hr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/hidden-keys.js"(e,r){r.exports={}}}),Pi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-keys-internal.js"(e,r){var t=me(),n=we(),o=vt(),i=Zd().indexOf,s=Hr(),a=t([].push);r.exports=function(c,d){var u=o(c),l=0,p=[],f;for(f in u)!n(s,f)&&n(u,f)&&a(p,f);for(;d.length>l;)n(u,f=d[l++])&&(~i(p,f)||a(p,f));return p}}}),Wr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/enum-bug-keys.js"(e,r){r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}}),Xd=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-keys.js"(e,r){var t=Pi(),n=Wr();r.exports=Object.keys||function(i){return t(i,n)}}}),ec=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-define-properties.js"(e){var r=Te(),t=_i(),n=Fe(),o=_t(),i=vt(),s=Xd();e.f=r&&!t?Object.defineProperties:function(c,d){o(c);for(var u=i(d),l=s(d),p=l.length,f=0,g;p>f;)n.f(c,g=l[f++],u[g]);return c}}}),tc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/html.js"(e,r){var t=er();r.exports=t("document","documentElement")}}),Kr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/shared-key.js"(e,r){var t=mi(),n=vi(),o=t("keys");r.exports=function(i){return o[i]||(o[i]=n(i))}}}),Gr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-create.js"(e,r){var t=_t(),n=ec(),o=Wr(),i=Hr(),s=tc(),a=bi(),c=Kr(),d=">",u="<",l="prototype",p="script",f=c("IE_PROTO"),g=function(){},m=function(T){return u+p+d+T+u+"/"+p+d},h=function(T){T.write(m("")),T.close();var E=T.parentWindow.Object;return T=null,E},y=function(){var T=a("iframe"),E="java"+p+":",C;return T.style.display="none",s.appendChild(T),T.src=String(E),C=T.contentWindow.document,C.open(),C.write(m("document.F=Object")),C.close(),C.F},w,b=function(){try{w=new ActiveXObject("htmlfile")}catch(E){}b=typeof document<"u"?document.domain&&w?h(w):y():h(w);for(var T=o.length;T--;)delete b[l][o[T]];return b()};i[f]=!0,r.exports=Object.create||function(E,C){var D;return E!==null?(g[l]=t(E),D=new g,g[l]=null,D[f]=E):D=b(),C===void 0?D:n.f(D,C)}}}),rc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/add-to-unscopables.js"(e,r){var t=yt(),n=Gr(),o=Fe().f,i=t("unscopables"),s=Array.prototype;s[i]==null&&o(s,i,{configurable:!0,value:n(null)}),r.exports=function(a){s[i][a]=!0}}}),$r=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/iterators.js"(e,r){r.exports={}}}),Ci=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/inspect-source.js"(e,r){var t=me(),n=ee(),o=Br(),i=t(Function.toString);n(o.inspectSource)||(o.inspectSource=function(s){return i(s)}),r.exports=o.inspectSource}}),nc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/native-weak-map.js"(e,r){var t=be(),n=ee(),o=Ci(),i=t.WeakMap;r.exports=n(i)&&/native code/.test(o(i))}}),Jr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/create-property-descriptor.js"(e,r){r.exports=function(t,n){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:n}}}}),Qr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/create-non-enumerable-property.js"(e,r){var t=Te(),n=Fe(),o=Jr();r.exports=t?function(i,s,a){return n.f(i,s,o(1,a))}:function(i,s,a){return i[s]=a,i}}}),Oi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/internal-state.js"(e,r){var t=nc(),n=be(),o=me(),i=St(),s=Qr(),a=we(),c=Br(),d=Kr(),u=Hr(),l="Object already initialized",p=n.TypeError,f=n.WeakMap,g,m,h,y=function(I){return h(I)?m(I):g(I,{})},w=function(I){return function(O){var k;if(!i(O)||(k=m(O)).type!==I)throw p("Incompatible receiver, "+I+" required");return k}};t||c.state?(b=c.state||(c.state=new f),T=o(b.get),E=o(b.has),C=o(b.set),g=function(I,O){if(E(b,I))throw new p(l);return O.facade=I,C(b,I,O),O},m=function(I){return T(b,I)||{}},h=function(I){return E(b,I)}):(D=d("state"),u[D]=!0,g=function(I,O){if(a(I,D))throw new p(l);return O.facade=I,s(I,D,O),O},m=function(I){return a(I,D)?I[D]:{}},h=function(I){return a(I,D)});var b,T,E,C,D;r.exports={set:g,get:m,has:h,enforce:y,getterFor:w}}}),oc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-property-is-enumerable.js"(e){"use strict";var r={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,n=t&&!r.call({1:2},1);e.f=n?function(i){var s=t(this,i);return!!s&&s.enumerable}:r}}),Ai=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-get-own-property-descriptor.js"(e){var r=Te(),t=tr(),n=oc(),o=Jr(),i=vt(),s=Ii(),a=we(),c=wi(),d=Object.getOwnPropertyDescriptor;e.f=r?d:function(l,p){if(l=i(l),p=s(p),c)try{return d(l,p)}catch(f){}if(a(l,p))return o(!t(n.f,l,p),l[p])}}}),Mi=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/function-name.js"(e,r){var t=Te(),n=we(),o=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,s=n(o,"name"),a=s&&function(){}.name==="something",c=s&&(!t||t&&i(o,"name").configurable);r.exports={EXISTS:s,PROPER:a,CONFIGURABLE:c}}}),ic=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/make-built-in.js"(e,r){var t=ge(),n=ee(),o=we(),i=Te(),s=Mi().CONFIGURABLE,a=Ci(),c=Oi(),d=c.enforce,u=c.get,l=Object.defineProperty,p=i&&!t(function(){return l(function(){},"length",{value:8}).length!==8}),f=String(String).split("String"),g=r.exports=function(m,h,y){String(h).slice(0,7)==="Symbol("&&(h="["+String(h).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),y&&y.getter&&(h="get "+h),y&&y.setter&&(h="set "+h),(!o(m,"name")||s&&m.name!==h)&&(i?l(m,"name",{value:h,configurable:!0}):m.name=h),p&&y&&o(y,"arity")&&m.length!==y.arity&&l(m,"length",{value:y.arity});try{y&&o(y,"constructor")&&y.constructor?i&&l(m,"prototype",{writable:!1}):m.prototype&&(m.prototype=void 0)}catch(b){}var w=d(m);return o(w,"source")||(w.source=f.join(typeof h=="string"?h:"")),m};Function.prototype.toString=g(function(){return n(this)&&u(this).source||a(this)},"toString")}}),zr=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/define-built-in.js"(e,r){var t=ee(),n=Fe(),o=ic(),i=qr();r.exports=function(s,a,c,d){d||(d={});var u=d.enumerable,l=d.name!==void 0?d.name:a;if(t(c)&&o(c,l,d),d.global)u?s[a]=c:i(a,c);else{try{d.unsafe?s[a]&&(u=!0):delete s[a]}catch(p){}u?s[a]=c:n.f(s,a,{value:c,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return s}}}),sc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-get-own-property-names.js"(e){var r=Pi(),t=Wr(),n=t.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(i){return r(i,n)}}}),ac=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-get-own-property-symbols.js"(e){e.f=Object.getOwnPropertySymbols}}),dc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/own-keys.js"(e,r){var t=er(),n=me(),o=sc(),i=ac(),s=_t(),a=n([].concat);r.exports=t("Reflect","ownKeys")||function(d){var u=o.f(s(d)),l=i.f;return l?a(u,l(d)):u}}}),cc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/copy-constructor-properties.js"(e,r){var t=we(),n=dc(),o=Ai(),i=Fe();r.exports=function(s,a,c){for(var d=n(a),u=i.f,l=o.f,p=0;p<d.length;p++){var f=d[p];!t(s,f)&&!(c&&t(c,f))&&u(s,f,l(a,f))}}}}),lc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/is-forced.js"(e,r){var t=ge(),n=ee(),o=/#|\.prototype\./,i=function(u,l){var p=a[s(u)];return p==d?!0:p==c?!1:n(l)?t(l):!!l},s=i.normalize=function(u){return String(u).replace(o,".").toLowerCase()},a=i.data={},c=i.NATIVE="N",d=i.POLYFILL="P";r.exports=i}}),uc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/export.js"(e,r){var t=be(),n=Ai().f,o=Qr(),i=zr(),s=qr(),a=cc(),c=lc();r.exports=function(d,u){var l=d.target,p=d.global,f=d.stat,g,m,h,y,w,b;if(p?m=t:f?m=t[l]||s(l,{}):m=(t[l]||{}).prototype,m)for(h in u){if(w=u[h],d.dontCallGetSet?(b=n(m,h),y=b&&b.value):y=m[h],g=c(p?h:l+(f?".":"#")+h,d.forced),!g&&y!==void 0){if(typeof w==typeof y)continue;a(w,y)}(d.sham||y&&y.sham)&&o(w,"sham",!0),i(m,h,w,d)}}}}),pc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/correct-prototype-getter.js"(e,r){var t=ge();r.exports=!t(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})}}),Ri=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-get-prototype-of.js"(e,r){var t=we(),n=ee(),o=hi(),i=Kr(),s=pc(),a=i("IE_PROTO"),c=Object,d=c.prototype;r.exports=s?c.getPrototypeOf:function(u){var l=o(u);if(t(l,a))return l[a];var p=l.constructor;return n(p)&&l instanceof p?p.prototype:l instanceof c?d:null}}}),Di=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/iterators-core.js"(e,r){"use strict";var t=ge(),n=ee(),o=Gr(),i=Ri(),s=zr(),a=yt(),c=Xt(),d=a("iterator"),u=!1,l,p,f;[].keys&&(f=[].keys(),"next"in f?(p=i(i(f)),p!==Object.prototype&&(l=p)):u=!0);var g=l==null||t(function(){var m={};return l[d].call(m)!==m});g?l={}:c&&(l=o(l)),n(l[d])||s(l,d,function(){return this}),r.exports={IteratorPrototype:l,BUGGY_SAFARI_ITERATORS:u}}}),ki=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/set-to-string-tag.js"(e,r){var t=Fe().f,n=we(),o=yt(),i=o("toStringTag");r.exports=function(s,a,c){s&&!c&&(s=s.prototype),s&&!n(s,i)&&t(s,i,{configurable:!0,value:a})}}}),fc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/create-iterator-constructor.js"(e,r){"use strict";var t=Di().IteratorPrototype,n=Gr(),o=Jr(),i=ki(),s=$r(),a=function(){return this};r.exports=function(c,d,u,l){var p=d+" Iterator";return c.prototype=n(t,{next:o(+!l,u)}),i(c,p,!1,!0),s[p]=a,c}}}),gc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/a-possible-prototype.js"(e,r){var t=ee(),n=String,o=TypeError;r.exports=function(i){if(typeof i=="object"||t(i))return i;throw o("Can't set "+n(i)+" as a prototype")}}}),mc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/object-set-prototype-of.js"(e,r){var t=me(),n=_t(),o=gc();r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},a;try{a=t(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),a(s,[]),i=s instanceof Array}catch(c){}return function(d,u){return n(d),o(u),i?a(d,u):d.__proto__=u,d}}():void 0)}}),hc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/internals/define-iterator.js"(e,r){"use strict";var t=uc(),n=tr(),o=Xt(),i=Mi(),s=ee(),a=fc(),c=Ri(),d=mc(),u=ki(),l=Qr(),p=zr(),f=yt(),g=$r(),m=Di(),h=i.PROPER,y=i.CONFIGURABLE,w=m.IteratorPrototype,b=m.BUGGY_SAFARI_ITERATORS,T=f("iterator"),E="keys",C="values",D="entries",I=function(){return this};r.exports=function(O,k,x,Y,ve,wt,qe){a(x,k,Y);var ue=function(Ee){if(Ee===ve&&ke)return ke;if(!b&&Ee in ae)return ae[Ee];switch(Ee){case E:return function(){return new x(this,Ee)};case C:return function(){return new x(this,Ee)};case D:return function(){return new x(this,Ee)}}return function(){return new x(this)}},Zr=k+" Iterator",nr=!1,ae=O.prototype,Be=ae[T]||ae["@@iterator"]||ve&&ae[ve],ke=!b&&Be||ue(ve),Xr=k=="Array"&&ae.entries||Be,Ie,ot,Tt;if(Xr&&(Ie=c(Xr.call(new O)),Ie!==Object.prototype&&Ie.next&&(!o&&c(Ie)!==w&&(d?d(Ie,w):s(Ie[T])||p(Ie,T,I)),u(Ie,Zr,!0,!0),o&&(g[Zr]=I))),h&&ve==C&&Be&&Be.name!==C&&(!o&&y?l(ae,"name",C):(nr=!0,ke=function(){return n(Be,this)})),ve)if(ot={values:ue(C),keys:wt?ke:ue(E),entries:ue(D)},qe)for(Tt in ot)(b||nr||!(Tt in ae))&&p(ae,Tt,ot[Tt]);else t({target:k,proto:!0,forced:b||nr},ot);return(!o||qe)&&ae[T]!==ke&&p(ae,T,ke,{name:ve}),g[k]=ke,ot}}}),vc=v({"../../node_modules/.pnpm/core-js@3.23.4/node_modules/core-js/modules/es.array.iterator.js"(e,r){"use strict";var t=vt(),n=rc(),o=$r(),i=Oi(),s=Fe().f,a=hc(),c=Xt(),d=Te(),u="Array Iterator",l=i.set,p=i.getterFor(u);r.exports=a(Array,"Array",function(g,m){l(this,{type:u,target:t(g),index:0,kind:m})},function(){var g=p(this),m=g.target,h=g.kind,y=g.index++;return!m||y>=m.length?(g.target=void 0,{value:void 0,done:!0}):h=="keys"?{value:y,done:!1}:h=="values"?{value:m[y],done:!1}:{value:[y,m[y]],done:!1}},"values");var f=o.Arguments=o.Array;if(n("keys"),n("values"),n("entries"),!c&&d&&f.name!=="values")try{s(f,"name",{value:"values"})}catch(g){}}});function yc(e,r){return r=r||{},new Promise(function(t,n){var o=new XMLHttpRequest,i=[],s=[],a={},c=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:c,headers:{keys:function(){return i},entries:function(){return s},get:function(u){return a[u.toLowerCase()]},has:function(u){return u.toLowerCase()in a}}}};for(var d in o.open(r.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(u,l,p){i.push(l=l.toLowerCase()),s.push([l,p]),a[l]=a[l]?a[l]+","+p:p}),t(c())},o.onerror=n,o.withCredentials=r.credentials=="include",r.headers)o.setRequestHeader(d,r.headers[d]);o.send(r.body||null)})}async function Sc(e){let r=P({"Content-Type":"application/json"},e.headers),t=await yc(e.url,{method:e.method,headers:r,body:_c(e)});if(t.ok)return bc(t);let n=new Error(t.statusText);return n.response=t,Promise.reject(n)}function _c(e){return typeof e.payload=="string"?e.payload:e.payload instanceof String?e.payload.valueOf():JSON.stringify(e.payload)}async function bc(e){let r="";e.headers&&e.headers.entries().forEach(n=>r+=`${n[0]}: ${n[1]}\r
`);let t={status:e.status,statusText:e.statusText,headers:r,data:""};try{let n=await e.json();t.data=n}catch(n){new Error(`response.payload cannot be parsed. Failed with error:
 ${n}`)}return t}var Qt,wc=new Uint8Array(16);function Tc(){if(!Qt&&(Qt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Qt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Qt(wc)}var Ic=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ec(e){return typeof e=="string"&&Ic.test(e)}var Pc=Ec,W=[];for(zt=0;zt<256;++zt)W.push((zt+256).toString(16).substr(1));var zt;function Cc(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(W[e[r+0]]+W[e[r+1]]+W[e[r+2]]+W[e[r+3]]+"-"+W[e[r+4]]+W[e[r+5]]+"-"+W[e[r+6]]+W[e[r+7]]+"-"+W[e[r+8]]+W[e[r+9]]+"-"+W[e[r+10]]+W[e[r+11]]+W[e[r+12]]+W[e[r+13]]+W[e[r+14]]+W[e[r+15]]).toLowerCase();if(!Pc(t))throw TypeError("Stringified UUID is invalid");return t}var Oc=Cc;function Ac(e,r,t){e=e||{};var n=e.random||(e.rng||Tc)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var o=0;o<16;++o)r[t+o]=n[o];return r}return Oc(n)}var Mc=Ac;function Rc(){return Mc()}var Ur={ffLibraryVersionCode:1,ffLibraryVersionName:"1.0.2-beta",ffLibraryLanguage:"Javascript",minimumPollFrequencySeconds:60},si="wmAppUserId",Yt="wmFeatureFlagConfig",ai="wmFeatureFlagUserId",di="wmFeatureFlagConfigEtag",Vr="wmFeatureFlagResults",ci="wmConfigCacheStart",li="Cache was used due to remote loading failing.",Dc="Fallback used because remote config loading failed.",kc="Fallback or cache used because remote config loading failed.",xc="Fallback used because a requested flag was present in it and not the remote.",Lc="Remote config used because a fallback config is not present.",jc="There was a problem reading the config object from storage, possibly due to invalid config JSON.",ht="Unable to access localStorage",Nc="Unable to access sessionStorage",Uc="A clientId must be provided for multiple instance support.",Vc=class{constructor(e,r){if(this.storageType=e,this.clientId=r,this.warnings=[],!this.clientId){let t={code:"MULTIPLE_INSTANCES_SUPPORT",message:`${Uc}`};this.warnings.push(t)}switch(this.storageType){case"localStorage":try{this.storage=localStorage}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${ht}: ${t}`};this.warnings.push(n)}break;case"sessionStorage":try{this.storage=sessionStorage}catch(t){let n={code:"UNABLE_TO_ACCESS_SESSION_STORAGE",message:`${Nc}: ${t}`};this.warnings.push(n)}break;case"inMemory":default:try{this.storage=localStorage;break}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${ht}: ${t}`};this.warnings.push(n)}}}get(e){let r;if(typeof Storage>"u")return;let t=e;this.clientId&&(t=`${t}-${this.clientId}`);try{r=this.storage.getItem(t)}catch(n){let o={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${ht}: ${n}`};this.warnings.push(o)}return r}set(e,r){if(typeof Storage>"u")return;let t=e;this.clientId&&(t=`${t}-${this.clientId}`);try{this.storage.setItem(t,r)}catch(n){let o={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${ht}: ${n}`};this.warnings.push(o)}}delete(e){if(typeof Storage>"u")return;let r=e;this.clientId&&(r=`${r}-${this.clientId}`);try{this.storage.deleteItem(r)}catch(t){let n={code:"UNABLE_TO_ACCESS_LOCAL_STORAGE",message:`${ht}: ${t}`};this.warnings.push(n)}}},hp=Nd(vc()),Fc=()=>{Object.entries||(Object.entries=function(e){let r=Object.keys(e),t=r.length,n=new Array(t);for(;t--;)n[t]=[r[t],e[r[t]]];return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(this==null)throw TypeError('"this" is null or not defined');let r=Object(this),t=r.length>>>0;if(typeof e!="function")throw TypeError("predicate must be a function");let n=arguments[1],o=0;for(;o<t;){let i=r[o];if(e.call(n,i,o,r))return i;o++}},configurable:!0,writable:!0})},qc=Fc,Fr="input is invalid type",_="0123456789abcdef".split(""),Bc=[-2147483648,8388608,32768,128],ce=[24,16,8,0],Zt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Hc=class{constructor(){this.blocks=[],this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}create(){return this}update(e){if(this.finalized)return;let r,t=typeof e;if(t!=="string"){if(t==="object"){if(e===null)throw new Error(Fr);if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error(Fr)}else throw new Error(Fr);r=!0}let n,o=0,i,s=e.length,a=this.blocks;for(;o<s;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),r)for(i=this.start;o<s&&i<64;++o)a[i>>2]|=e[o]<<ce[i++&3];else for(i=this.start;o<s&&i<64;++o)n=e.charCodeAt(o),n<128?a[i>>2]|=n<<ce[i++&3]:n<2048?(a[i>>2]|=(192|n>>6)<<ce[i++&3],a[i>>2]|=(128|n&63)<<ce[i++&3]):n<55296||n>=57344?(a[i>>2]|=(224|n>>12)<<ce[i++&3],a[i>>2]|=(128|n>>6&63)<<ce[i++&3],a[i>>2]|=(128|n&63)<<ce[i++&3]):(n=65536+((n&1023)<<10|e.charCodeAt(++o)&1023),a[i>>2]|=(240|n>>18)<<ce[i++&3],a[i>>2]|=(128|n>>12&63)<<ce[i++&3],a[i>>2]|=(128|n>>6&63)<<ce[i++&3],a[i>>2]|=(128|n&63)<<ce[i++&3]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=a[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}finalize(){if(this.finalized)return;this.finalized=!0;let e=this.blocks,r=this.lastByteIndex;e[16]=this.block,e[r>>2]|=Bc[r&3],this.block=e[16],r>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}hash(){let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,i=this.h5,s=this.h6,a=this.h7,c,d,u,l,p,f,g,m,h,y,w,b=this.blocks;for(c=16;c<64;++c)p=b[c-15],d=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,p=b[c-2],u=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,b[c]=b[c-16]+d+b[c-7]+u<<0;for(w=r&t,c=0;c<64;c+=4)this.first?(m=704751109,p=b[0]-210244248,a=p-1521486534<<0,n=p+143694565<<0,this.first=!1):(d=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),u=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),m=e&r,l=m^e&t^w,g=o&i^~o&s,p=a+u+g+Zt[c]+b[c],f=d+l,a=n+p<<0,n=p+f<<0),d=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),u=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),h=n&e,l=h^n&r^m,g=a&o^~a&i,p=s+u+g+Zt[c+1]+b[c+1],f=d+l,s=t+p<<0,t=p+f<<0,d=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),u=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),y=t&n,l=y^t&e^h,g=s&a^~s&o,p=i+u+g+Zt[c+2]+b[c+2],f=d+l,i=r+p<<0,r=p+f<<0,d=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),u=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),w=r&t,l=w^r&n^y,g=i&s^~i&a,p=o+u+g+Zt[c+3]+b[c+3],f=d+l,o=e+p<<0,e=p+f<<0;this.h0=this.h0+e<<0,this.h1=this.h1+r<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+o<<0,this.h5=this.h5+i<<0,this.h6=this.h6+s<<0,this.h7=this.h7+a<<0}hex(){this.finalize();let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,i=this.h5,s=this.h6,a=this.h7,c=_[e>>28&15]+_[e>>24&15]+_[e>>20&15]+_[e>>16&15]+_[e>>12&15]+_[e>>8&15]+_[e>>4&15]+_[e&15]+_[r>>28&15]+_[r>>24&15]+_[r>>20&15]+_[r>>16&15]+_[r>>12&15]+_[r>>8&15]+_[r>>4&15]+_[r&15]+_[t>>28&15]+_[t>>24&15]+_[t>>20&15]+_[t>>16&15]+_[t>>12&15]+_[t>>8&15]+_[t>>4&15]+_[t&15]+_[n>>28&15]+_[n>>24&15]+_[n>>20&15]+_[n>>16&15]+_[n>>12&15]+_[n>>8&15]+_[n>>4&15]+_[n&15]+_[o>>28&15]+_[o>>24&15]+_[o>>20&15]+_[o>>16&15]+_[o>>12&15]+_[o>>8&15]+_[o>>4&15]+_[o&15]+_[i>>28&15]+_[i>>24&15]+_[i>>20&15]+_[i>>16&15]+_[i>>12&15]+_[i>>8&15]+_[i>>4&15]+_[i&15]+_[s>>28&15]+_[s>>24&15]+_[s>>20&15]+_[s>>16&15]+_[s>>12&15]+_[s>>8&15]+_[s>>4&15]+_[s&15];return c+=_[a>>28&15]+_[a>>24&15]+_[a>>20&15]+_[a>>16&15]+_[a>>12&15]+_[a>>8&15]+_[a>>4&15]+_[a&15],c}toString(){return this.hex()}digest(){this.finalize();let e=this.h0,r=this.h1,t=this.h2,n=this.h3,o=this.h4,i=this.h5,s=this.h6,a=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,o>>24&255,o>>16&255,o>>8&255,o&255,i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255];return c.push(a>>24&255,a>>16&255,a>>8&255,a&255),c}array(){return this.digest()}arrayBuffer(){this.finalize();let e=new ArrayBuffer(32),r=new DataView(e);return r.setUint32(0,this.h0),r.setUint32(4,this.h1),r.setUint32(8,this.h2),r.setUint32(12,this.h3),r.setUint32(16,this.h4),r.setUint32(20,this.h5),r.setUint32(24,this.h6),r.setUint32(28,this.h7),e}};qc();var xi=class{constructor(e,r,t=!1){if(this.addStorageWarnings=()=>{let o=[];return this.storage.warnings&&this.storage.warnings.length>0&&this.storage.warnings.map(i=>{o.push(i)}),o},this.targetingPropsToLowerCase=o=>Object.entries(o).reduce((i,[s,a])=>{let c;return typeof a=="string"&&(c=a.toLowerCase()),Array.isArray(a)&&(c=a.map(d=>d.toLowerCase())),i[s.toLowerCase()]=c,i},{}),!e)throw new Error("Please provide a context object to the constructor.");if(!e.configUrl&&!r)throw new Error("Please provide either a config url or a valid config object.");this.config=void 0,this.configRefreshIntervalDefault=Ur.minimumPollFrequencySeconds,this.context=e,this.fallbackConfig=r,this.featureFlagUserId="",this.libraryLanguage=Ur.ffLibraryLanguage,this.initialized=!1,this.quickInit=t;let n=e&&e.storageType?e.storageType:"";this.storage=new Vc(n,e.clientId),this.globalWarnings=[]}createHash(e,r){let n=new Hc().create();return n.update(`${e}${r}`),n.hex()}createUserId(){return Rc()}getUserFeatureIndex(e){return parseInt(e.substring(0,10),16).toString().slice(-2)}async init(){let e=[],{config:r,fallbackConfig:t,initialized:n,featureFlagUserId:o,libraryLanguage:i,storage:s,configRefreshIntervalDefault:a,quickInit:c}=this,{configUrl:d,userId:u,configRefreshInterval:l}=this.context,p=typeof l<"u"?l:a,f=this.checkConfigCacheExpiry(p);if(!r||f){let g=s.get(Yt);try{g&&(this.config=JSON.parse(g))}catch(m){let h={code:"FAILED_TO_READ_CONFIG_FROM_STORAGE",message:jc};e.push(h)}if(!g||f)if(d){!f&&t&&this.updateConfig(t);let m=s.get(di)||"-1";m=g?m:"-1";try{if(c&&t)return g||this.updateConfig(t),this.loadAndSetRemoteConfig(d,m),e;if(c&&!t){let h={code:"REMOTE_CONFIG_USED_NO_FALLBACK_PRESENT",message:Lc};e.push(h)}await this.loadAndSetRemoteConfig(d,m)}catch(h){if(g||t)this.setNoNewConfigWarning();else throw new Error(`Failed to load config file - no config url or default config provided. ${h}`)}}else{if(!t)throw new Error("Failed to load config file - no config url or default config provided.");this.updateConfig(t)}}if(n)return e;if(u)s.set(si,u);else{let g=s.get(si);g&&(this.context.userId=g)}if(!o){let g=s.get(ai);g&&(this.featureFlagUserId=g),g||(this.featureFlagUserId=this.createUserId(),s.set(ai,this.featureFlagUserId))}if(!this.context.userTargetingProperties||this.context.userTargetingProperties&&!this.context.userTargetingProperties.ffLibraryLanguage){let g={ffLibraryLanguage:i};this.updateContext(void 0,g)}return this.initialized=!0,e}checkConfigCacheExpiry(e){let{storage:r}=this,t=new Date,n=!1,o=c=>r.set(ci,c),i=r.get(ci);if(!i){let c=new Date;o(JSON.stringify(c.getTime()))}let s=i?JSON.parse(i):t.getTime();if(n=t.getTime()-s>e,n===!0){let c=new Date;o(JSON.stringify(c.getTime()))}return n}async isFeatureEnabled(e){return(await this.queryFeatureFlag(e)).enabled}setNoNewConfigWarning(){let{fallbackConfig:e,storage:r}=this,t=r.get(Yt);if(t){let n={code:"CACHE_USED",message:li};this.globalWarnings.push(n)}else!t&&e&&(this.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:li}),this.updateConfig(e))}parseHeaders(e){return e.split(`\r
`).reduce(function(t,n){let o=n.split(": ");return t[o[0]]=o[1],t},{})}async loadAndSetRemoteConfig(e,r){try{let t=await this.loadConfig(e,r);if(t){this.config=t.data?t.data:this.config,t.data||this.globalWarnings.push({code:"FALLBACK_USED_REMOTE_LOAD_FAILED",message:Dc});let n=t.headers&&t.headers.etag?t.headers.etag:"";t.headers&&typeof t.headers=="string"&&(n=this.parseHeaders(t.headers).etag),n&&this.storage.set(di,n),this.storage.set(Yt,JSON.stringify(this.config))}}catch(t){this.globalWarnings.push({code:"FALLBACK_OR_CACHE_USED_REMOTE_LOAD_FAILED",message:kc}),this.setNoNewConfigWarning()}}async loadConfig(e,r="-1"){let t,n=`${e}?version=${Ur.ffLibraryVersionCode}`,o={"If-None-Match":r},i={headers:o};try{t=await Sc({url:n,method:"GET",headers:o})}catch(s){throw new Error(`Failed to fetch config file: ${s}`)}return t}updateConfig(e){this.config=e,this.storage.set(Yt,JSON.stringify(e))}updateContext(e,r,t){let n=P({},this.context);if(e&&(n.userId=e),t)n.userTargetingProperties=r;else{let o=P(P({},n.userTargetingProperties),r);n.userTargetingProperties=o}this.context=n}getCohortConfig(e,r){let t=e.userId?"appUserId":"ffUserId",n={rolloutValue:"-1",cohortPriority:1,stickinessProperty:t},o=[...r];o.sort((a,c)=>a.cohortPriority>c.cohortPriority?1:-1);let i=this.targetingPropsToLowerCase(e.userTargetingProperties),s=o.find(a=>{let c=!1;if(!e.userId&&a.stickinessProperty==="appUserId")return!1;if(!a.cohortCriteria||a.cohortCriteria.length<1)return!0;let d=a.cohortCriteria;for(let u=0;u<d.length;u++){let{requiredFieldName:l}=d[u],{requiredFieldValues:p}=d[u];if(l=l.toLowerCase(),c=p.some(g=>{if(g=g.toLowerCase(),!i.hasOwnProperty(l)&&g==="")return!0;if(typeof i[l]=="string")return i[l]===g;if(Array.isArray(i[l]))return i[l].some(m=>m===g)}),!c)break}return c});return s&&(n=P({},s)),n}cacheFlagResults(e){let{storage:r}=this,t=[],n=[],o=[];Array.isArray(e)?o=e?[...e]:[]:o.push(e);let i=r.get(Vr);t=[...i?JSON.parse(i):[]],t.length>0&&(n=t.reduce((c,d)=>o.find(u=>u.flagId===d.flagId)?c:[...c,d],[]));let a=[...n,...o];return r.set(Vr,JSON.stringify(a)),a}checkIfFlagUpdated(e){let{storage:r}=this,t=r.get(Vr),n=t?JSON.parse(t):[];if(n.length<1)return!0;let o=n.find(s=>s.flagId===e.flagId);return o?o.enabled!==e.enabled:!0}async queryFeatureFlag(e,r=!1){let{context:t,fallbackConfig:n}=this,o=!1,i,s,a,c,d,u="appUserId",l=[],p=y=>{let w=r?[]:this.globalWarnings;return l.concat(y,w)},f=(y,w)=>y.flags.find(b=>b.id===w),g=(y,w)=>{if(i=f(y,w),i){let b=this.addStorageWarnings();l=p(b);let T={clientId:t.clientId,flagId:i.id,flagName:i.name?i.name:void 0,enabled:i.defaultValue,updatedSinceLastQuery:!0,warnings:l};return T.updatedSinceLastQuery=this.checkIfFlagUpdated(T),this.cacheFlagResults(T),T}};try{if(l=(await this.init()).concat(l),c=this.context.userId?this.context.userId:void 0,!this.config||!this.config.flags)throw new Error("Operation failed - no config file or invalid config file detected.");if(i=f(this.config,e),!i){if(n){let x=g(n,e);if(x){let Y={code:"FALLBACK_USED_FLAG_NOT_IN_REMOTE",message:xc};return l.push(Y),x}}throw new Error("Flag not found")}let{cohorts:w,defaultValue:b,name:T,type:E}=i;if(E&&E.toLowerCase()!=="boolean"&&!r)throw new Error("Flag not found");if(!w||w.length<1){let x=this.addStorageWarnings();l=p(x);let Y={clientId:t.clientId,flagId:i.id,flagName:T,enabled:i.defaultValue,updatedSinceLastQuery:!0,warnings:l};return Y.updatedSinceLastQuery=this.checkIfFlagUpdated(Y),this.cacheFlagResults(Y),Y}s=T;let C=this.getCohortConfig(t,w),{rolloutValue:D}=C,{stickinessProperty:I}=C;D=D||"0";let O=i.id;a=this.context.userId?this.context.userId:void 0,I==="ffUserId"&&(c=this.featureFlagUserId,u="ffUserId",a=c);let k=a?this.createHash(a,O):void 0;if(d=k?this.getUserFeatureIndex(k):"-1",o=parseInt(d,10)<parseInt(D,10),parseInt(D,10)<0||parseInt(d,10)<0||parseInt(d,10)>99){if(typeof b>"u"){if(n){let x=g(n,e);if(x)return x;throw new Error("Flag not found")}throw new Error("Unable to determine flag default value")}o=b}}catch(y){throw new Error(`Failed to query feature flag: ${y}`)}let m=this.addStorageWarnings();l=p(m);let h={flagId:e,flagName:s,enabled:o,updatedSinceLastQuery:!0,clientId:t.clientId,userId:c,userIdType:u,warnings:l};return h.updatedSinceLastQuery=this.checkIfFlagUpdated(h),this.cacheFlagResults(h),h}async queryAllFeatureFlags(){await this.init();let{config:e}=this;if(!e||!e.flags)throw new Error("No config file or invalid config file detected.");let r={anyFlagsUpdatedSinceLastQuery:!1,globalWarnings:this.globalWarnings,results:[]},t=e.flags.map(async n=>{let o=await this.queryFeatureFlag(n.id,!0);o.updatedSinceLastQuery===!0&&(r.anyFlagsUpdatedSinceLastQuery=!0),r.results.push(o)});return Promise.all(t).then(()=>r)}};var Qi=or(Pr()),Yr=or(Bi());He();function Yc(e){let r=e;return typeof r<"u"&&r!==null&&(r.constructor==={}.constructor||r.constructor===[].constructor)}function Zc(e){if(!Yc(e))return!1;for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!0;return!1}function le(){let e={},r=(i,s)=>{s!=null&&s!==""&&(e[i]=s)};return{add:r,addMap:i=>{for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&r(s,i[s])},addJson:(i,s)=>{if(s&&Zc(s)){let a=JSON.stringify(s);r(i,a)}},build:()=>e}}function Xc(e){return e==null||e==null?new Date().toISOString():new Date(e).toISOString()}var Hi=e=>{let r={};return Array.isArray(e)?e:(Object.entries(e).forEach(([t,n])=>{n===Object(n)?r[t]=Hi(n):n!=null&&(r[t]=e[t])}),r)};function Wi(e){let r={},t=(o,i)=>{r[o]=i},n=(o,i,s)=>{o.addMap(Hi(r)),o.add("eventTimestamp",Xc(i)),o.add("eventId",pe()),typeof e=="function"&&e(o);try{s&&s(o.build())}catch(a){console.warn("[PSM]: error running custom callback")}return o};return{addEntry:t,setPlatform(o){t("platform",o)},setBrand(o){t("brand",o)},setSubBrand(o){t("subBrand",o)},setProductName(o){t("productName",o)},setWMUKID(o){t("wmukid",o)},setThirdPartyIds(o){t("ids",o)},setDevice(o){t("device",o)},setNavigationProperties(o){t("navigationProperties",o)},setClientResolvedIp(o){t("clientResolvedIp",o)},setLocation(o){t("location",o)},setConsentProperties(o){t("consentProperties",o)},setIABCategories(o){t("iabConsentCategories",o)},setLibrary(o){let s=window.WM,a=s==null?void 0:s.UserConsent,c=null;a&&(c={version:a.getVersion(),usingPsm:a.usingPSM(),initConfig:s.UserConsentConfig}),t("library",P({wmucLibrary:c},o))},setEventProperties(o){t("eventProperties",o)},setSessionProperties(o){t("session",o)},setAdsProperties(o){t("adsProperties",o)},setContentMetadata(o){t("contentMetadata",o)},trackAppLoad(o,i){let s=le();return s.add("eventType","telemetry"),s.add("eventName","appLoad"),n(s,o,i)},trackHeartbeat(o,i){let s=le();return s.add("eventType","telemetry"),s.add("eventName","heartbeat"),n(s,o,i)},trackPubSub(o,i,s){let a=le(),c={eventTrigger:"pubsub"};return a.add("eventType","telemetry"),a.add("eventName",o),t("eventProperties",c),n(a,i,s)},trackIdentityRegistration(o,i,s){let a=le();return a.add("eventType","identity"),a.add("eventName",o),n(a,i,s)},trackTokenEvent(o,i,s){let a=le();return a.add("eventType","token"),a.add("eventName",o),n(a,i,s)},trackConsentUpdated(o,i,s,a){let c=le(),d={eventTrigger:o,uspString:i==null?void 0:i.usp,region:i==null?void 0:i.region};return c.add("eventType","privacy"),c.add("eventName","consent update"),t("eventProperties",d),n(c,s,a)},trackConsentGranted(o,i){let s=le();return s.add("eventType","privacy"),s.add("eventName","ccpaShareData"),n(s,o,i)},trackConsentWithdrawn(o,i){let s=le();return s.add("eventType","privacy"),s.add("eventName","ccpaShareData"),n(s,o,i)},trackPageExit(o,i,s){let a=le();return a.add("eventType","telemetry"),a.add("eventName","pageExit"),a.add("eventTrigger",o),n(a,i,s)},trackInbrain(o,i,s){let a=le();return a.add("eventType","telemetry"),a.add("eventName",o),n(a,i,s)}}}function Ki(e){return(r,t)=>{let n=["bot","crawl","spider"];if(new RegExp(n.join("|"),"i").test(window.navigator.userAgent))return t(null,{});r.sentAtTimestamp=new Date().toISOString(),se(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(i=>t(null,i)).catch(i=>{R({err:i,methodName:"sendRequest",eventType:r.eventType||"queue"}),t(i)})}}var Gi=(e,r)=>{let t=r.psmObject;t.initPsm=e.initPsm.bind(e),t.getVersion=e.getVersion.bind(e),t.getWMUKID=r.getWMUKID.bind(e),t.getCDPID=r.getCDPID.bind(e),t.getConfig=e.getConfig.bind(e),t.getConsentProperties=r.getConsentProperties.bind(e),t.getBrand=e.getBrand.bind(e),t.getBrandToken=e.getBrandToken.bind(e),t.getSubBrand=e.getSubBrand.bind(e),t.getCoppaPrivacyMode=e.getCoppaPrivacyMode.bind(e),t.getDeviceProperties=e.getDeviceProperties.bind(e),t.getIds=e.getIds.bind(e),t.getLibrary=e.getLibrary.bind(e),t.getLocationProperties=e.getLocationProperties.bind(e),t.getDeviceProperties=e.getDeviceProperties.bind(e),t.getNavigationProperties=e.getNavigationProperties.bind(e),t.getSessionProperties=e.getSessionProperties.bind(e),t.isDopplerIdentityOnStartEnabled=()=>e.queryFlag("doppler-identity-onstart"),t.isDopplerIdentityOnCompleteEnabled=()=>e.queryFlag("doppler-identity-oncomplete"),t.isDopplerPrivacyEnabled=()=>e.queryFlag("doppler-privacy"),t.isDopplerTelemetryEnabled=()=>e.queryFlag("doppler-telemetry"),e.setUspData&&(t.setUspData=e.setUspData.bind(e),t.getUspBoolean=e.getUspBoolean.bind(e),t.getUspString=e.getUspString.bind(e),t.getComScoreFromUsp=e.getComScoreFromUsp.bind(e),t.getUspData=e.getUspData.bind(e))};var bt=null;function $i(e,r){window.document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(Fo(),clearInterval(bt),bt=null,r()):(qo(),Gt(),Jt(),bt=bt||setInterval(e,3e4))},!1),bt=setInterval(e,3e4)}var Ji="3.2.1";var F=class extends Qn{constructor(){super();F.dependencies=ii(this),Gi(this,F.dependencies),F.dependencies.getFlags=this.getFlags.bind(this),F.dependencies.getAdsProperties=this.getAdsProperties.bind(this)}async initPsm(t){let n=window,o=n.psmInitialized;if(this.ready||o)return;if(this.browser=io(),this.config.browser=this.browser,this.config=Object.assign(this.config,t),Co(this),typeof t>"u")throw new Error("[PSM]: Please provide a valid configuration to initPsm");let i=async()=>{let a=t.psmEnvironment.toUpperCase(),c=Wi();if(this.core=c,this.requestQueue=new Qi.default("prismCE",Rt,Ki(A.identity[a])),window.location===window.parent.location){if(this.wmukid=F.dependencies.initWMUKID(this.coppaPrivacyMode),this.coppaPrivacyMode!==Yr.COPPAPrivacyModesEnum.ZERO_ID){this.cdpid=await F.dependencies.initCDPID(a);for(let d of document.links)d instanceof HTMLAnchorElement&&d.href.includes("hbomax.com/subscribe/plan-picker")&&d.addEventListener("click",()=>{L(this,c),c.trackPageExit("click",new Date().toISOString(),u=>{u.navigationProperties.destination=d.href,u.sentAtTimestamp=new Date().toISOString(),navigator.sendBeacon(A.identity[a],JSON.stringify(u))})});await this.resolveIds(),this.setSendHHIDCookie(),this.setSendWMSegs(),this.setSendAuth2Token(),F.dependencies.resolveAuthTokens(c,S,this),window.ZionMessageBus&&window.ZionMessageBus.getInstance().publish("id_found",{type:"wmukid",value:this.wmukid})}if(this.setSessionProperties(!0),this.setIsInExperiment("isInAuthTokenExperiment"),this.setIsInExperiment("isInHHIDExperiment"),L(this,c),c.trackIdentityRegistration("identity on page start",new Date().toISOString(),d=>{this.queryFlag("doppler-identity-onstart")&&(this.requestQueue.addItem(d),this.resetNewSessionFields()),a==="AUTOMATED_TEST"&&window.localStorage.setItem("payload-on-start",JSON.stringify(d))}),window.addEventListener("load",()=>{this.setSessionProperties(),L(this,c),c.trackIdentityRegistration("identity on page complete",new Date().toISOString(),d=>{this.queryFlag("doppler-identity-oncomplete")&&(this.requestQueue.addItem(d),a==="AUTOMATED_TEST"&&window.localStorage.setItem("payload-on-complete",JSON.stringify(d)),this.resetNewSessionFields())})}),document.addEventListener("userConsentChanged",d=>{R({message:"userConsentChanged event received",methodName:"initPsm",eventType:"privacy",context:{eventDetails:d.detail}}),this.setSessionProperties(),L(this,c),c.trackConsentUpdated("userConsentChanged",d.detail,new Date().toISOString(),u=>{this.queryFlag("doppler-consent-update")&&(R({message:"Consent Update event registered",methodName:"initPsm",eventType:"privacy",context:{payload:u}}),this.requestQueue.addItem(u),this.resetNewSessionFields())})}),this.queryFlag("doppler-heartbeat-event")&&(Vo(),Go(),this.wmukid!=="Unknown"&&($i(()=>{Bo(),mt(),this.setSessionProperties(),L(this,c),c.trackHeartbeat(new Date().toISOString(),u=>{this.requestQueue.addItem(u),this.resetNewSessionFields(),Jt(),Gt()})},()=>{mt(),L(this,c),c.trackPageExit("visibilitychange",new Date().toISOString(),u=>{u.sentAtTimestamp=new Date().toISOString(),window.navigator.sendBeacon(A.identity[a],JSON.stringify(u))})}),window.addEventListener("beforeunload",()=>{mt(),L(this,c),c.trackPageExit("beforeunload",new Date().toISOString(),u=>{u.sentAtTimestamp=new Date().toISOString(),window.navigator.sendBeacon(A.identity[a],JSON.stringify(u))})}),window.addEventListener("pagehide",u=>{u.persisted||(mt(),L(this,c),c.trackPageExit("pagehide",new Date().toISOString(),l=>{l.sentAtTimestamp=new Date().toISOString(),window.navigator.sendBeacon(A.identity[a],JSON.stringify(l))}))}))),this.queryFlag("doppler-pubsub-event"))for(let d in t.topics)t.topics[d].forEach(u=>{window.PubSub&&window.PubSub.subscribe(u,(...l)=>{let p=typeof l[1]=="object"?l[1]:l[0];p=Object.keys(p).length<3&&p.video?p.video:p,window.psmPubSubData=window.psmPubSubData||{},window.psmPubSubData[d]=window.psmPubSubData[d]||{},Object.assign(window.psmPubSubData[d],p),L(this,c),c.trackPubSub(u,new Date().toISOString(),f=>{this.requestQueue.addItem(f),this.resetNewSessionFields()})})});if(this.requestQueue.start(),this.coppaPrivacyMode!==Yr.COPPAPrivacyModesEnum.ZERO_ID)try{ti(this,c)}catch(d){Me({err:d,eventType:"inbrain",methodName:"initInbrain"})}this.ready=!0,n.psmInitialized=!0}};if(this.validateConfig(t),this.countryCode=this.hasProperty("countryCode",t)&&typeof t.countryCode<"u"&&this.config.countryCode.length?this.config.countryCode.toUpperCase():"",Ke.includes(this.countryCode)||this.countryCode==="")try{this.location=await se(A.locate),this.countryCode=this.countryCode===""?this.location.country_alpha2:this.countryCode}catch(a){this.location.country=void 0,this.location.country_alpha2=void 0}try{let{shouldLoad:a,categories:c}=await Mo();Ke.includes(this.countryCode)?this.consentRule="US":a&&c.length>0&&(this.consentRule="GDPR"),this.consentCategories=c.reduce((d,u)=>P(P({},d),u),{})}catch(a){this.consentCategories={}}this.initCoppaPrivacyMode();let s=`psmFFClient-${this.config.brand}-${this.config.subBrand}`;this.ffClient=new xi({configUrl:A.featureFlag[t.psmEnvironment.toUpperCase()],configRefreshInterval:6e4,userTargetingProperties:{Platform:["Web"],Brand:[t.brand],Browser:this.browser,ClientID:s,CountryCode:this.countryCode},clientId:s});try{let a=await this.ffClient.queryAllFeatureFlags();this.flags=a.results,(this.consentRule==="US"||this.consentRule==="GDPR"&&this.queryFlag("outside-us-location-check"))&&await i()}catch(a){console.log("[PSM]: Error encountered during location check",a)}}getWMUKID(){return F.dependencies.getWMUKID()}getCDPID(){return F.dependencies.getCDPID()}getConsentProperties(){return F.dependencies.getConsentProperties()}setSendHHIDCookie(){let t=this.queryFlag("sendHHID");return S.set("sendHHID",t)}setSendAuth2Token(){let t=this.queryFlag("sendAuthToken2");return S.set("sendAuthToken",t),S.set("sendAuthToken2",t)}setIsInExperiment(t){let n=this.queryFlag(t);return S.set(t,n)}setSendWMSegs(){let t=this.queryFlag("sendWMSegs");return S.set("sendWMSegs",t)}async resolveIds(){if(!this.queryFlag("idresolve"))return R({message:"[PSM]: idresolve flag is disabled",methodName:"resolveIds",eventType:"idresolution"}),!1;let t=S.get("idrTimestamp");if(t){let o=new Date(t),s=(new Date().getTime()-o.getTime())/1e3/60/60;if(s<24)return Ue({message:`[PSM]: IDR lifespan, ${s}, less than 24 hours`,methodName:"resolveIds",eventType:"idresolution"}),!1}let n={wmukid:F.dependencies.getWMUKID(),ids:{attuuid:et(),cdpid:F.dependencies.getCDPID(),cnnuid:Ve(),convivaid:rt(),ecid:tt(),kruxid:Xe(),wmhhid:S.get("wmhhid"),wminid:S.get("wminid"),zionid:nt()}};try{let o=await se(A.idresolve[this.config.psmEnvironment],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),{wmhhid:i,wminid:s,wmsegs:a,hhidVersion:c}=o;i||S.remove("wmhhid"),a||localStorage.removeItem("wmsegs"),i&&S.set("wmhhid",i),c&&S.set("hhidVersion",c.toString()),s&&S.set("wminid",s),a&&localStorage.setItem("wmsegs",a)}catch(o){R({err:o,eventType:"idresolution",methodName:"sendRequest"})}return S.set("idrTimestamp",new Date),!0}getPageLoadId(t,n){let o=S.get("psmPageLoadId"),i=o&&parseInt(o),s=i;return t&&(s=1),!t&&n&&i&&(s=i+1),s}setSessionProperties(t=!1){let n=new Date,o={isSessionStart:!0,pageloadid:this.getPageLoadId(!0,t),psmLastActiveTimestamp:n.toISOString(),psmSessionStart:n.toISOString(),sessionDuration:0,sessionid:pe()},i=S.get("psmSessionId"),s=S.get("psmSessionStart"),a=S.get("psmLastActiveTimestamp");if(i!==null){let c=new Date(a),d=new Date(s),u=n.getTime()-c.getTime();u>18e5?(Ue({message:`[PSM]: Session ${i} timed out after ${u/1e3} seconds.`,methodName:"setSessionProperties",eventType:"session"}),o=te(P({},o),{previousSession:{psmLastActiveTimestamp:a,psmSessionStart:s,sessionDuration:(c.getTime()-d.getTime())/1e3,sessionid:i}})):(R({message:`[PSM]: Session ${i} still active after ${u/1e3} seconds. Updating last active timestamp.`,methodName:"setSessionProperties",eventType:"session"}),o={isSessionStart:!1,pageloadid:this.getPageLoadId(!1,t),psmLastActiveTimestamp:n.toISOString(),psmSessionStart:s,sessionDuration:(n.getTime()-d.getTime())/1e3,sessionid:i})}else Ue({message:"[PSM]: Creating new session",methodName:"setSessionProperties",eventType:"session"});S.set("psmSessionId",o.sessionid),S.set("psmLastActiveTimestamp",o.psmLastActiveTimestamp),S.set("psmSessionStart",o.psmSessionStart),S.set("psmPageLoadId",JSON.stringify(o.pageloadid)),this.session=o}resetNewSessionFields(){this.session=te(P({},this.session),{isSessionStart:!1,previousSession:null})}getFlags(){return this.flags.reduce((t,n)=>te(P({},t),{[n.flagId]:n}),{})}getAdsProperties(){return{guid:jr()||"",transid:Lr()||"",ads:ie}}getDeviceProperties(){return{type:F.dependencies.platform,userAgent:window.navigator.userAgent}}getLibrary(){return{name:"Prism JS",version:Ji,initConfig:this.config}}getIds(){return{attuuid:et()||"",cdpid:F.dependencies.getCDPID(),cnnuid:Ve()||"",convivaid:rt()||"",ecid:tt()||"",kruxid:Xe()||"",liverampatsid:S.get("tok_lr"),wmhhid:S.get("wmhhid"),wminid:S.get("wminid"),zionid:nt()||""}}getNavigationProperties(){return{url:window.location.href,rootDomain:kt(window.location.href),referrer:jt(),path:window.location.pathname,search:window.location.search,title:window.document.title}}queryFlag(t){let n=$n[t]||!1;try{let{enabled:o}=this.flags.find(i=>i.flagId===t);n=o}catch(o){Oo({err:o,methodName:"queryFlag",eventType:"featureFlagging"})}return n}};var zi=new F;window.psmVideo=te(P({},window.psmVideo),{top2:{startMonitoring:e=>new Gn(e,zi)},discovery:{startMonitoring:e=>new Kn(e,zi)}});})();
//# sourceMappingURL=psm.legacy.min.umd.js.map